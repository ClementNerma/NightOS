<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Desktop environments - NightOS documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Design and specification documents for NightOS">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">NightOS documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ClementNerma/NightOS" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="desktop-environment"><a class="header" href="#desktop-environment">Desktop Environment</a></h1>
<p>The <em>Desktop Environment</em> (DE) is an application that acts as the main graphical interface of NightOS.</p>
<p>It is launched with the system, does never stop until the system itself stops, and handles most of the user interface.</p>
<h2 id="desktop-environment-applications"><a class="header" href="#desktop-environment-applications">Desktop Environment Applications</a></h2>
<p>A <em>desktop environment application</em> (DEA) can only be launched by the system, and is only launched once during the whole system's lifetime, except for their commands which can be launched by anyone. It is also the very first application to be run.</p>
<p>There are two default DEA: <a href="../applications/Nova.html">Nova</a>, and <a href="../applications/BareEnv.html">BareEnv</a>.</p>
<p>The former acts as the default, reference and recommanded DE of NightOS, while the latter is for servers and other computers without a graphical output. It only supports text-based workflows, which limits it to command-line usage.</p>
<p>An application can register itself as a DEA by exposing a <code>SYS_DENV</code> service in its <a href="../specs/applications.html#execution-context">manifest</a>.</p>
<h2 id="permissions"><a class="header" href="#permissions">Permissions</a></h2>
<p>A <a href="#desktop-environment-applications">DEA</a> does not require specific permissions in order to work ; it only requires to expose a <a href="../specs/services/integration/desktop-environments.html">specific integration service</a> in its <a href="../specs/applications.html#execution-context">manifest</a>.</p>
<h2 id="display-layers"><a class="header" href="#display-layers">Display layers</a></h2>
<p>The graphical interface is split into <em>layers</em>, which represent the display priority when two elements overlap. For instance, when two elements A and B overlap visually (= part of them is displayed at the same coordinate than the other), the element located in the highest layer will be displayed on top of the other element.</p>
<p>Layers are indexed, starting from <code>0</code> with the lowest priority.</p>
<h2 id="windows"><a class="header" href="#windows">Windows</a></h2>
<p>Windows are the base display element for applications. They can take any form depending on the DE's display method, but are usually made of the application's drawing zone and a titlebar.</p>
<p>Some desktop environments may not accept windows (for instance, <a href="../applications/BareEnv.html">BareEnv</a> which is a text-only desktop environment). In such case, most applications will fail to run as they won't be able to build windows, but this is still allowed.</p>
<h2 id="security-and-operation"><a class="header" href="#security-and-operation">Security and operation</a></h2>
<p>Unlike other operating systems, <a href="#desktop-environment-applications">DEA</a> can only access their own data and cannot manipulate the data inside other applications, even graphically.</p>
<p>Desktop environments rely on the <a href="../specs/services/system/ui.html"><code>sys::ui</code></a> system service to control the data they display.</p>
<p>This service provides them several <a href="../specs/services.html#communication">methods and events</a>, mainly to:</p>
<ul>
<li>Display graphical elements on <a href="#display-layers">layer 0</a></li>
<li>Display the content of a window at provided coordinates</li>
<li>Notify a window owner that its window should be closed</li>
<li>Notify a window that a part of its <a href="#window-states">state should change</a></li>
<li>Reject a window's <a href="#window-states">state change</a></li>
<li>Be notified when a window's <a href="#window-states">state changes</a></li>
</ul>
<p>At no moment can the desktop environment access the graphical content of a window, nor affect it, as windows are displayed starting from <a href="#display-layers">layer 1</a>.</p>
<p>On the other hand, the desktop environment can force a window owner (the application process that created it) to resize, minimize, restore, put to fullscreen, etc. and can also hide some elements from the system as it is not forced to display a window's content.</p>
<h2 id="window-states"><a class="header" href="#window-states">Window states</a></h2>
<p>A window's state is made of its characteristics:</p>
<ul>
<li>Title</li>
<li>Buttons</li>
<li>Icon</li>
<li>Dimensions (width / height)</li>
<li>Coordinates (X and Y)</li>
<li><a href="#activeinactive-windows">Active attribute</a></li>
<li><a href="#interactive-windows">Interactive attribute</a></li>
<li><a href="#fixed-size-windows">Fixed-size attribute</a></li>
<li><a href="#display-layers">Display layer</a></li>
<li><a href="#window-display-state">Display state</a></li>
<li>Custom state attributes</li>
</ul>
<p>The custom attributes are handled by the DEA itself, and can contain any piece of information relevant to displaying the window, such as the virtual desktop number if the DE supports it.</p>
<h3 id="window-display-state"><a class="header" href="#window-display-state">Window display state</a></h3>
<p>Windows have a <em>display state</em> which indicate how they are displayed on the screen. These states can be:</p>
<ul>
<li><strong>Restored</strong>: the default</li>
<li><strong>Maximized:</strong> the window takes all the available space, minus the space used by its optional titlebar and the elements displayed by the desktop environment</li>
<li><strong>Minimized:</strong> the window is hidden but still available</li>
<li><strong>Fullscreenized:</strong> the windows takes all the screen, hiding all other windows and elements from the desktop environment, including its own titlebar</li>
</ul>
<h2 id="activeinactive-windows"><a class="header" href="#activeinactive-windows">Active/inactive windows</a></h2>
<p>All windows are considered <em>inactive</em> unless they are <em>focused</em>, which on most desktop environments put them on the top layer. There are no specific difference between active and inactive windows, but this attribute is indicated to the owner application as this may impact the desired behaviour of the application.</p>
<h2 id="interactive-windows"><a class="header" href="#interactive-windows">Interactive windows</a></h2>
<p>By default, windows are <em>interactive</em>, meaning user inputs can be sent to them. They may be set <em>non-interactive</em> to stop receiving such events and preventing users from interacting with them.</p>
<h2 id="fixed-size-windows"><a class="header" href="#fixed-size-windows">Fixed-size windows</a></h2>
<p>Fixed-size windows are windows whose size is fixed and cannot be resized by the end user.</p>
<h2 id="common-elements"><a class="header" href="#common-elements">Common elements</a></h2>
<p>Desktop environment are traditionally made of several elements:</p>
<ul>
<li>The <em>taskbar</em> lists all opened windows</li>
<li>The <em>notification center</em> centralizes all <a href="notifications.html">pending notifications</a></li>
<li>The <em>titlebar</em> is an element put on each window to see its title, icon and control <a href="#window-states">its state</a></li>
</ul>
<p>These elements are common but are <strong><em>NOT</em></strong> required to be present in a desktop environment.</p>
<h2 id="interface-windows"><a class="header" href="#interface-windows">Interface windows</a></h2>
<p><em>Interface windows</em> are windows that are created by another application to be used in a specific part of the desktop environment. It results in the integration of an application with the current DEA.</p>
<p>Interface windows are created the same way as usual windows, but do not usually have a titlebar and can often not be moved. They are mostly used to create widgets and display context menus on items.</p>
<p>Typically, an interface windows created by an application is hidden by default, and the DEA shows it only after getting its identifier returned by the service it is communicating with.</p>
<h2 id="popups"><a class="header" href="#popups">Popups</a></h2>
<p>Popups are special windows which are not drawable directly by the application. They usually contain a single icon, as well as a message and at least one clickable button. They are used to transmit informations to the end user, such as an error or a warning message.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../ux/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../ux/notifications.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../ux/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../ux/notifications.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>

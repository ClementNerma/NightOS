<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Shell scripting - NightOS documentation</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Design and specification documents for NightOS">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../FOREWORD.html"><strong aria-hidden="true">1.</strong> Foreword</a></li><li class="chapter-item expanded "><a href="../FAQ.html"><strong aria-hidden="true">2.</strong> Frequently-asked questions</a></li><li class="chapter-item expanded "><a href="../project/index.html"><strong aria-hidden="true">3.</strong> Project</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../project/roadmap.html"><strong aria-hidden="true">3.1.</strong> Roadmap</a></li><li class="chapter-item expanded "><a href="../project/development.html"><strong aria-hidden="true">3.2.</strong> Development</a></li><li class="chapter-item expanded "><a href="../project/hw-requirements.html"><strong aria-hidden="true">3.3.</strong> Hardware requirements</a></li></ol></li><li class="chapter-item expanded "><a href="../concepts/index.html"><strong aria-hidden="true">4.</strong> Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../concepts/applications.html"><strong aria-hidden="true">4.1.</strong> What are applications?</a></li><li class="chapter-item expanded "><a href="../concepts/libraries.html"><strong aria-hidden="true">4.2.</strong> What are libraries?</a></li><li class="chapter-item expanded "><a href="../concepts/users.html"><strong aria-hidden="true">4.3.</strong> What are users?</a></li></ol></li><li class="chapter-item expanded "><a href="../features/index.html"><strong aria-hidden="true">5.</strong> Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../features/balancer.html"><strong aria-hidden="true">5.1.</strong> The balancer</a></li><li class="chapter-item expanded "><a href="../features/crash-saves.html"><strong aria-hidden="true">5.2.</strong> Crash saves</a></li><li class="chapter-item expanded "><a href="../features/domains.html"><strong aria-hidden="true">5.3.</strong> Domains</a></li><li class="chapter-item expanded "><a href="../features/encryption.html"><strong aria-hidden="true">5.4.</strong> Encryption</a></li><li class="chapter-item expanded "><a href="../features/freeze-prevention.html"><strong aria-hidden="true">5.5.</strong> Freeze-prevention system</a></li><li class="chapter-item expanded "><a href="../features/parental-control.html"><strong aria-hidden="true">5.6.</strong> Parental control</a></li><li class="chapter-item expanded "><a href="../features/sandboxes.html"><strong aria-hidden="true">5.7.</strong> Sandboxes</a></li><li class="chapter-item expanded "><a href="../features/synchronization.html"><strong aria-hidden="true">5.8.</strong> Synchronization</a></li></ol></li><li class="chapter-item expanded "><a href="../technical/index.html"><strong aria-hidden="true">6.</strong> Technical</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../technical/overview.html"><strong aria-hidden="true">6.1.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../technical/controller.html"><strong aria-hidden="true">6.2.</strong> The controller</a></li><li class="chapter-item expanded "><a href="../technical/dev-mode.html"><strong aria-hidden="true">6.3.</strong> Developer mode</a></li><li class="chapter-item expanded "><a href="../technical/devices.html"><strong aria-hidden="true">6.4.</strong> Devices</a></li><li class="chapter-item expanded "><a href="../technical/file-formats.html"><strong aria-hidden="true">6.5.</strong> File formats</a></li><li class="chapter-item expanded "><a href="../technical/integrity-checker.html"><strong aria-hidden="true">6.6.</strong> Integrity checker</a></li><li class="chapter-item expanded "><a href="../technical/io-manager.html"><strong aria-hidden="true">6.7.</strong> I/O manager</a></li><li class="chapter-item expanded "><a href="../technical/multi-platform.html"><strong aria-hidden="true">6.8.</strong> Multi-platform management</a></li><li class="chapter-item expanded "><a href="../technical/performances.html"><strong aria-hidden="true">6.9.</strong> Performances</a></li><li class="chapter-item expanded "><a href="../technical/pre-compiling.html"><strong aria-hidden="true">6.10.</strong> Pre-compiling applications</a></li><li class="chapter-item expanded "><a href="../technical/processes.html"><strong aria-hidden="true">6.11.</strong> Processes</a></li><li class="chapter-item expanded "><a href="../technical/registry.html"><strong aria-hidden="true">6.12.</strong> The registry</a></li><li class="chapter-item expanded "><a href="../technical/services.html"><strong aria-hidden="true">6.13.</strong> Services</a></li><li class="chapter-item expanded "><a href="../technical/shell.html"><strong aria-hidden="true">6.14.</strong> The shell</a></li></ol></li><li class="chapter-item expanded "><a href="../ux/index.html"><strong aria-hidden="true">7.</strong> User Experience</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ux/desktop-environment.html"><strong aria-hidden="true">7.1.</strong> Desktop environments</a></li><li class="chapter-item expanded "><a href="../ux/notifications.html"><strong aria-hidden="true">7.2.</strong> Notifications</a></li><li class="chapter-item expanded "><a href="../ux/sound.html"><strong aria-hidden="true">7.3.</strong> Sound</a></li></ol></li><li class="chapter-item expanded "><a href="../specs/index.html"><strong aria-hidden="true">8.</strong> Specifications</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../specs/applications-libraries.html"><strong aria-hidden="true">8.1.</strong> Applications and libraries</a></li><li class="chapter-item expanded "><a href="../specs/applications.html"><strong aria-hidden="true">8.2.</strong> Applications</a></li><li class="chapter-item expanded "><a href="../specs/filesystem.html"><strong aria-hidden="true">8.3.</strong> Filesystem</a></li><li class="chapter-item expanded "><a href="../specs/storage-permissions-map.html"><strong aria-hidden="true">8.4.</strong> Storage permissions map</a></li><li class="chapter-item expanded "><a href="../specs/libraries.html"><strong aria-hidden="true">8.5.</strong> Libraries</a></li><li class="chapter-item expanded "><a href="../specs/permissions.html"><strong aria-hidden="true">8.6.</strong> Permissions</a></li><li class="chapter-item expanded "><a href="../specs/containers.html"><strong aria-hidden="true">8.7.</strong> Containers</a></li><li class="chapter-item expanded "><a href="../specs/registry.html"><strong aria-hidden="true">8.8.</strong> The registry</a></li><li class="chapter-item expanded "><a href="../specs/vocabulary.html"><strong aria-hidden="true">8.9.</strong> Vocabulary</a></li><li class="chapter-item expanded "><a href="../specs/shell.html"><strong aria-hidden="true">8.10.</strong> The shell</a></li><li class="chapter-item expanded "><a href="../specs/shell-scripting.html" class="active"><strong aria-hidden="true">8.11.</strong> Shell scripting</a></li><li class="chapter-item expanded "><a href="../specs/services.html"><strong aria-hidden="true">8.12.</strong> Services</a></li><li class="chapter-item expanded "><a href="../specs/kernel/index.html"><strong aria-hidden="true">8.13.</strong> Kernel</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../specs/kernel/hardware.html"><strong aria-hidden="true">8.13.1.</strong> Hardware</a></li><li class="chapter-item expanded "><a href="../specs/kernel/memory.html"><strong aria-hidden="true">8.13.2.</strong> Memory</a></li><li class="chapter-item expanded "><a href="../specs/kernel/processes.html"><strong aria-hidden="true">8.13.3.</strong> Processes</a></li><li class="chapter-item expanded "><a href="../specs/kernel/scheduling.html"><strong aria-hidden="true">8.13.4.</strong> Scheduling</a></li><li class="chapter-item expanded "><a href="../specs/kernel/data-structures.html"><strong aria-hidden="true">8.13.5.</strong> Data structures</a></li><li class="chapter-item expanded "><a href="../specs/kernel/kpc.html"><strong aria-hidden="true">8.13.6.</strong> Kernel-process communication</a></li><li class="chapter-item expanded "><a href="../specs/kernel/ipc.html"><strong aria-hidden="true">8.13.7.</strong> Inter-process communication</a></li><li class="chapter-item expanded "><a href="../specs/kernel/signals.html"><strong aria-hidden="true">8.13.8.</strong> Signals</a></li><li class="chapter-item expanded "><a href="../specs/kernel/syscalls.html"><strong aria-hidden="true">8.13.9.</strong> System calls</a></li></ol></li><li class="chapter-item expanded "><a href="../specs/services/integration/index.html"><strong aria-hidden="true">8.14.</strong> Integration services</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../specs/services/integration/desktop-environments.html"><strong aria-hidden="true">8.14.1.</strong> Desktop environments</a></li><li class="chapter-item expanded "><a href="../specs/services/integration/file-managers.html"><strong aria-hidden="true">8.14.2.</strong> File managers</a></li><li class="chapter-item expanded "><a href="../specs/services/integration/file-openers.html"><strong aria-hidden="true">8.14.3.</strong> File openers</a></li><li class="chapter-item expanded "><a href="../specs/services/integration/filesystem-interfaces.html"><strong aria-hidden="true">8.14.4.</strong> Filesystem interfaces</a></li></ol></li><li class="chapter-item expanded "><a href="../specs/services/drivers/index.html"><strong aria-hidden="true">8.15.</strong> Driver services</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../specs/services/drivers/storage.html"><strong aria-hidden="true">8.15.1.</strong> Storage driver service</a></li></ol></li><li class="chapter-item expanded "><a href="../specs/services/system/index.html"><strong aria-hidden="true">8.16.</strong> System services</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../specs/services/system/fs.html"><strong aria-hidden="true">8.16.1.</strong> sys::fs</a></li><li class="chapter-item expanded "><a href="../specs/services/system/fsh.html"><strong aria-hidden="true">8.16.2.</strong> sys::fsh</a></li><li class="chapter-item expanded "><a href="../specs/services/system/hw.html"><strong aria-hidden="true">8.16.3.</strong> sys::hw</a></li><li class="chapter-item expanded "><a href="../specs/services/system/perm.html"><strong aria-hidden="true">8.16.4.</strong> sys::perm</a></li><li class="chapter-item expanded "><a href="../specs/services/system/net.html"><strong aria-hidden="true">8.16.5.</strong> sys::net</a></li><li class="chapter-item expanded "><a href="../specs/services/system/crypto.html"><strong aria-hidden="true">8.16.6.</strong> sys::crypto</a></li><li class="chapter-item expanded "><a href="../specs/services/system/crashsave.html"><strong aria-hidden="true">8.16.7.</strong> sys::crashsave</a></li><li class="chapter-item expanded "><a href="../specs/services/system/flow.html"><strong aria-hidden="true">8.16.8.</strong> sys::flow</a></li><li class="chapter-item expanded "><a href="../specs/services/system/hydre.html"><strong aria-hidden="true">8.16.9.</strong> sys::hydre</a></li><li class="chapter-item expanded "><a href="../specs/services/system/app.html"><strong aria-hidden="true">8.16.10.</strong> sys::app</a></li><li class="chapter-item expanded "><a href="../specs/services/system/process.html"><strong aria-hidden="true">8.16.11.</strong> sys::process</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../applications/index.html"><strong aria-hidden="true">9.</strong> Applications</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../applications/Astral.html"><strong aria-hidden="true">9.1.</strong> Astral</a></li><li class="chapter-item expanded "><a href="../applications/BareEnv.html"><strong aria-hidden="true">9.2.</strong> BareEnv</a></li><li class="chapter-item expanded "><a href="../applications/Blackhole.html"><strong aria-hidden="true">9.3.</strong> Blackhole</a></li><li class="chapter-item expanded "><a href="../applications/Central.html"><strong aria-hidden="true">9.4.</strong> Central</a></li><li class="chapter-item expanded "><a href="../applications/Cloudy.html"><strong aria-hidden="true">9.5.</strong> Cloudy</a></li><li class="chapter-item expanded "><a href="../applications/Comet.html"><strong aria-hidden="true">9.6.</strong> Comet</a></li><li class="chapter-item expanded "><a href="../applications/Gravity.html"><strong aria-hidden="true">9.7.</strong> Gravity</a></li><li class="chapter-item expanded "><a href="../applications/Locky.html"><strong aria-hidden="true">9.8.</strong> Locky</a></li><li class="chapter-item expanded "><a href="../applications/Milkshake.html"><strong aria-hidden="true">9.9.</strong> Milkshake</a></li><li class="chapter-item expanded "><a href="../applications/Monitor.html"><strong aria-hidden="true">9.10.</strong> Monitor</a></li><li class="chapter-item expanded "><a href="../applications/Nova.html"><strong aria-hidden="true">9.11.</strong> Nova</a></li><li class="chapter-item expanded "><a href="../applications/Particle.html"><strong aria-hidden="true">9.12.</strong> Particle</a></li><li class="chapter-item expanded "><a href="../applications/Pluton.html"><strong aria-hidden="true">9.13.</strong> Pluton</a></li><li class="chapter-item expanded "><a href="../applications/Postal.html"><strong aria-hidden="true">9.14.</strong> Postal</a></li><li class="chapter-item expanded "><a href="../applications/Reader.html"><strong aria-hidden="true">9.15.</strong> Reader</a></li><li class="chapter-item expanded "><a href="../applications/Registry.html"><strong aria-hidden="true">9.16.</strong> Registry</a></li><li class="chapter-item expanded "><a href="../applications/Rocket.html"><strong aria-hidden="true">9.17.</strong> Rocket</a></li><li class="chapter-item expanded "><a href="../applications/ShootingStar.html"><strong aria-hidden="true">9.18.</strong> ShootingStar</a></li><li class="chapter-item expanded "><a href="../applications/Skyer.html"><strong aria-hidden="true">9.19.</strong> Skyer</a></li><li class="chapter-item expanded "><a href="../applications/Sonata.html"><strong aria-hidden="true">9.20.</strong> Sonata</a></li><li class="chapter-item expanded "><a href="../applications/Stellar.html"><strong aria-hidden="true">9.21.</strong> Stellar</a></li><li class="chapter-item expanded "><a href="../applications/Thinker.html"><strong aria-hidden="true">9.22.</strong> Thinker</a></li><li class="chapter-item expanded "><a href="../applications/TimeTravel.html"><strong aria-hidden="true">9.23.</strong> TimeTravel</a></li><li class="chapter-item expanded "><a href="../applications/Vortex.html"><strong aria-hidden="true">9.24.</strong> Vortex</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">NightOS documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ClementNerma/NightOS" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="shell-scripting"><a class="header" href="#shell-scripting">Shell scripting</a></h1>
<p>The scripting language of <a href="../technical/shell.html">Hydre</a> offers a lot of powerful easy-to-use features. This allows to create complex script that are still very readable and maintanable.</p>
<ul>
<li><a href="#running-a-command">Running a command</a>
<ul>
<li><a href="#combining-short-arguments">Combining short arguments</a></li>
<li><a href="#argument-values">Argument values</a></li>
</ul>
</li>
<li><a href="#comments">Comments</a></li>
<li><a href="#variables">Variables</a></li>
<li><a href="#value-types">Value types</a>
<ul>
<li><a href="#variables-shadowing">Variables shadowing</a></li>
</ul>
</li>
<li><a href="#expressions">Expressions</a></li>
<li><a href="#computing-values">Computing values</a>
<ul>
<li><a href="#mathematical-operators">Mathematical operators</a></li>
<li><a href="#bit-wise-operators">Bit-wise operators</a></li>
<li><a href="#logical-operators">Logical operators</a></li>
<li><a href="#assignment-operators">Assignment operators</a></li>
</ul>
</li>
<li><a href="#lists-and-maps">Lists and maps</a></li>
<li><a href="#blocks">Blocks</a>
<ul>
<li><a href="#conditionals">Conditionals</a></li>
<li><a href="#switches">Switches</a></li>
<li><a href="#loops">Loops</a></li>
<li><a href="#filesystem-iteration">Filesystem iteration</a></li>
<li><a href="#variables-scoping">Variables scoping</a></li>
</ul>
</li>
<li><a href="#functions">Functions</a>
<ul>
<li><a href="#arguments">Arguments</a></li>
<li><a href="#return-types">Return types</a></li>
<li><a href="#methods">Methods</a></li>
<li><a href="#failing">Failing</a>
<ul>
<li><a href="#retries">Retries</a></li>
<li><a href="#global-failing">Global failing</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#nullable-types">Nullable types</a>
<ul>
<li><a href="#handle-the-null-value">Handle the <code>null</code> value</a></li>
<li><a href="#the-case-of-optional-arguments">The case of optional arguments</a></li>
<li><a href="#nullable-any">Nullable <code>any</code></a></li>
</ul>
</li>
<li><a href="#advanced-types">Advanced types</a>
<ul>
<li><a href="#structures">Structures</a></li>
<li><a href="#closures">Closures</a></li>
<li><a href="#streams">Streams</a></li>
</ul>
</li>
<li><a href="#data-validation">Data validation</a></li>
<li><a href="#event-listeners">Event listeners</a>
<ul>
<li><a href="#waiting">Waiting</a></li>
</ul>
</li>
<li><a href="#imports">Imports</a>
<ul>
<li><a href="#aliases">Aliases</a></li>
<li><a href="#import-expansions">Import expansions</a></li>
<li><a href="#non-clashing-namespace">Non-clashing namespace</a></li>
<li><a href="#volatile-imports">Volatile imports</a></li>
</ul>
</li>
<li><a href="#commands-input--output">Commands input &amp; output</a>
<ul>
<li><a href="#reading-a-commands-output">Reading a command's output</a></li>
<li><a href="#redirecting-the-output-to-a-file">Redirecting the output to a file</a></li>
<li><a href="#output-data">Output data</a>
<ul>
<li><a href="#reading-from-cmdin">Reading from CMDIN</a></li>
<li><a href="#returning-with-cmdout">Returning with CMDOUT</a></li>
<li><a href="#writing-to-cmdraw">Writing to CMDRAW</a></li>
</ul>
</li>
<li><a href="#input-of-a-command">Input of a command</a></li>
</ul>
</li>
<li><a href="#running-in-background">Running in background</a></li>
<li><a href="#environment-variables">Environment variables</a>
<ul>
<li><a href="#reading-an-environment-variable">Reading an environment variable</a></li>
</ul>
</li>
<li><a href="#commands-typing">Commands typing</a>
<ul>
<li><a href="#arguments-type">Arguments type</a></li>
<li><a href="#enumerations">Enumerations</a></li>
<li><a href="#return-type">Return type</a></li>
<li><a href="#conditionals-1">Conditionals</a></li>
<li><a href="#example">Example</a></li>
</ul>
</li>
<li><a href="#native-library">Native library</a>
<ul>
<li><a href="#utilities">Utilities</a>
<ul>
<li><a href="#envvarname-string---any"><code>env(varname: string) -&gt; any?</code></a></li>
<li><a href="#promptmessage-string---string"><code>prompt(message: string) -&gt; string</code></a></li>
<li><a href="#prompt_intmessage-string---fallible-int"><code>prompt_int(message: string) -&gt; fallible int</code></a></li>
<li><a href="#prompt_floatmessage-string---fallible-float"><code>prompt_float(message: string) -&gt; fallible float</code></a></li>
<li><a href="#confirmmessage-string---fallible-bool"><code>confirm(message: string) -&gt; fallible bool</code></a></li>
<li><a href="#chooseoptions-liststring---fallible-int"><code>choose(options: list[string]) -&gt; fallible int</code></a></li>
<li><a href="#retry_cmdcmd-command-retries-int---fallible"><code>retry_cmd(cmd: command, retries: int) -&gt; fallible</code></a></li>
<li><a href="#exit"><code>exit()</code></a></li>
<li><a href="#last_failed---bool"><code>last_failed() -&gt; bool</code></a></li>
<li><a href="#rand---float"><code>rand() -&gt; float</code></a></li>
<li><a href="#rand_intlow-int-up-int---fallible-int"><code>rand_int(low: int, up: int) -&gt; fallible int</code></a></li>
<li><a href="#rand_floatlow-float-up-float---fallible-float"><code>rand_float(low: float, up: float) -&gt; fallible float</code></a></li>
</ul>
</li>
<li><a href="#all-types">All types</a>
<ul>
<li><a href="#anystr---string"><code>any.str() -&gt; string</code></a></li>
</ul>
</li>
<li><a href="#nullable-types-1">Nullable types</a>
<ul>
<li><a href="#tisnull---t"><code>T?.isNull() -&gt; T</code></a></li>
<li><a href="#tdefaultfallback-t---t"><code>T?.default(fallback: T) -&gt; T</code></a></li>
<li><a href="#tunwrap---t"><code>T?.unwrap() -&gt; T</code></a></li>
<li><a href="#texpectmessage-string---t"><code>T?.expect(message: string) -&gt; T</code></a></li>
</ul>
</li>
<li><a href="#characters">Characters</a>
<ul>
<li><a href="#charsingle---bool"><code>char.single() -&gt; bool</code></a></li>
<li><a href="#charcodepoints---listint"><code>char.codepoints() -&gt; list[int]</code></a></li>
<li><a href="#charlen---int"><code>char.len() -&gt; int</code></a></li>
<li><a href="#charbytes---int"><code>char.bytes() -&gt; int</code></a></li>
</ul>
</li>
<li><a href="#strings">Strings</a>
<ul>
<li><a href="#stringchars---listchar"><code>string.chars() -&gt; list[char]</code></a></li>
<li><a href="#stringcodepoints---listint"><code>string.codepoints() -&gt; list[int]</code></a></li>
<li><a href="#stringlen---int"><code>string.len() -&gt; int</code></a></li>
<li><a href="#stringbytes---int"><code>string.bytes() -&gt; int</code></a></li>
<li><a href="#stringparse_intbase--10---fallible-int"><code>string.parse_int(base = 10) -&gt; fallible int</code></a></li>
<li><a href="#stringparse_floatbase--10---fallible-float"><code>string.parse_float(base = 10) -&gt; fallible float</code></a></li>
<li><a href="#stringupper_case---string"><code>string.upper_case() -&gt; string</code></a></li>
<li><a href="#stringlower_case---string"><code>string.lower_case() -&gt; string</code></a></li>
<li><a href="#stringreverse---string"><code>string.reverse() -&gt; string</code></a></li>
<li><a href="#stringconcatright-string---string"><code>string.concat(right: string) -&gt; string</code></a></li>
<li><a href="#stringsplitstr-string-sep-string---string"><code>string.split(str: string, sep: string) -&gt; string</code></a></li>
</ul>
</li>
<li><a href="#lists">Lists</a>
<ul>
<li><a href="#listcharstringify---str"><code>list[char].stringify() -&gt; str</code></a></li>
<li><a href="#liststringjoinsep-----string"><code>list[string].join(sep = &quot;,&quot;) -&gt; string</code></a></li>
<li><a href="#listtgetindex-int---t"><code>list[T].get(index: int) -&gt; T?</code></a></li>
<li><a href="#listtexpectindex-number-message-string---t"><code>list[T].expect(index: number, message: string) -&gt; T</code></a></li>
<li><a href="#listtunshiftvalue-t"><code>list[T].unshift(value: T)</code></a></li>
<li><a href="#listtpushvalue-t"><code>list[T].push(value: T)</code></a></li>
<li><a href="#listtunshift---t"><code>list[T].unshift() -&gt; T?</code></a></li>
<li><a href="#listtpop---t"><code>list[T].pop() -&gt; T?</code></a></li>
<li><a href="#listtsortasc--true---listt"><code>list[T].sort(asc = true) -&gt; list[T]</code></a></li>
<li><a href="#listtreverse---listt"><code>list[T].reverse() -&gt; list[T]</code></a></li>
<li><a href="#listtlen---int"><code>list[T].len() -&gt; int</code></a></li>
<li><a href="#listtconcatanother-listt---listt"><code>list[T].concat(another: list[T]) -&gt; list[T]</code></a></li>
<li><a href="#listtconcatlists-listlistt---listt"><code>list[T].concat(lists: list[list[T]]) -&gt; list[T]</code></a></li>
</ul>
</li>
<li><a href="#maps">Maps</a>
<ul>
<li><a href="#mapk-vhaskey-k---bool"><code>map[K, V].has(key: K) -&gt; bool</code></a></li>
<li><a href="#mapk-vgetkey-k---v"><code>map[K, V].get(key: K) -&gt; V?</code></a></li>
<li><a href="#mapk-vkeys---listk"><code>map[K, V].keys() -&gt; list[K]</code></a></li>
<li><a href="#mapk-vvalues---listv"><code>map[K, V].values() -&gt; list[V]</code></a></li>
<li><a href="#mapk-vvalues---liststruct--key-k-value-v-"><code>map[K, V].values() -&gt; list[struct { key: K, value: V }]</code></a></li>
<li><a href="#mapk-vexpectkey-k-message-string---v"><code>map[K, V].expect(key: K, message: string) -&gt; V</code></a></li>
<li><a href="#mapk-vdeletekey-k---bool"><code>map[K, V].delete(key: K) -&gt; bool</code></a></li>
<li><a href="#mapk-vcount---int"><code>map[K, V].count() -&gt; int</code></a></li>
</ul>
</li>
<li><a href="#commands">Commands</a>
<ul>
<li><a href="#commandrun---int"><code>command.run() -&gt; int</code></a></li>
<li><a href="#commandfallible"><code>command.fallible()</code></a></li>
<li><a href="#commandret_str---string"><code>command.ret_str() -&gt; string</code></a></li>
<li><a href="#commandcmdraw---stream"><code>command.cmdraw() -&gt; stream</code></a></li>
<li><a href="#commandcmdmsg---liststring"><code>command.cmdmsg() -&gt; list[string]</code></a></li>
<li><a href="#commandcmderr---liststring"><code>command.cmderr() -&gt; list[string]</code></a></li>
<li><a href="#commandoutput---liststring"><code>command.output() -&gt; list[string]</code></a></li>
</ul>
</li>
<li><a href="#streams-1">Streams</a>
<ul>
<li><a href="#streampending---bool"><code>stream.pending() -&gt; bool</code></a></li>
<li><a href="#streamsize_hint---int"><code>stream.size_hint() -&gt; int?</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#examples">Examples</a>
<ul>
<li><a href="#guess-the-number">Guess The Number</a></li>
</ul>
</li>
<li><a href="#native-commands">Native commands</a>
<ul>
<li><a href="#echo-display-a-value"><code>echo</code>: display a value</a></li>
<li><a href="#wt-write-a-file"><code>wt</code>: write a file</a></li>
<li><a href="#rd-read-a-file"><code>rd</code>: read a file</a></li>
<li><a href="#mkdir-create-a-directory"><code>mkdir</code>: create a directory</a></li>
<li><a href="#ren-rename-a-filesystem-item"><code>ren</code>: rename a filesystem item</a></li>
<li><a href="#mv-move-a-filesystem-item"><code>mv</code>: move a filesystem item</a></li>
<li><a href="#rm-remove-a-filesystem-item"><code>rm</code>: remove a filesystem item</a></li>
<li><a href="#ls-list-filesystem-items"><code>ls</code>: list filesystem items</a></li>
<li><a href="#fd-find-filesystem-items"><code>fd</code>: find filesystem items</a></li>
<li><a href="#syml-manage-symlinks"><code>syml</code>: manage symlinks</a></li>
</ul>
</li>
</ul>
<h2 id="running-a-command"><a class="header" href="#running-a-command">Running a command</a></h2>
<p>Hydre uses an intuitive syntax. Commands are written like they would be in *-sh shells: the command name is followed by arguments, each separated by a space.</p>
<p>Arugments can either be positional (they are written directly), shorts (prefixed by a <code>-</code> symbol and one-character long), or longs (prefixed by two <code>-</code> symbols). Here is an example:</p>
<pre><code class="language-hydre">cmdname &quot;pos1&quot; &quot;pos2&quot; -a --arg1
</code></pre>
<p>This line runs the command called <code>cmdname</code>, provides two positional arguments <code>pos1</code> and <code>pos2</code>, a short one <code>a</code> and a long one <code>arg1</code>.
Short and long arguments are called <em>dash arguments</em>.</p>
<h3 id="combining-short-arguments"><a class="header" href="#combining-short-arguments">Combining short arguments</a></h3>
<p>It's possible to combine multiple short arguments in once by writing them one after the other:</p>
<pre><code class="language-hydre">cmdname -abc
</code></pre>
<p>This line is strictly equivalent to:</p>
<pre><code class="language-hydre">cmdname -a -b -c
</code></pre>
<h3 id="argument-values"><a class="header" href="#argument-values">Argument values</a></h3>
<p>Short and long arguments can also require a value. This value must be provided using an <code>=</code> symbol or by simply using a space:</p>
<pre><code class="language-hydre">cmdname -s=1 --long=2
# or:
cmdname -s 1 --long 2
</code></pre>
<h2 id="comments"><a class="header" href="#comments">Comments</a></h2>
<p>Comments can be written on a single line with the <code>#</code> symbol:</p>
<pre><code class="language-hydre">cmdname # single-line comment
</code></pre>
<p>Everything after the <code>#</code> symbol is ignored. For multiple-line comments, it's required to use three <code>#</code> symbols:</p>
<pre><code class="language-hydre">###
this
is a
multi-line
comment
###
</code></pre>
<h2 id="variables"><a class="header" href="#variables">Variables</a></h2>
<p>Variables are declared with the <code>var</code> keyword:</p>
<pre><code class="language-hydre">var age = 19
</code></pre>
<p>Here, we declare a variable <code>age</code> with value <code>19</code>. As variables are typed, this variable will only be allowed to contain numbers from now on - no strings, no booleans, nothing else.</p>
<p>And to assign a new value to it:</p>
<pre><code class="language-hydre">age = 20
</code></pre>
<h2 id="value-types"><a class="header" href="#value-types">Value types</a></h2>
<p>All arguments must match their expected <em>type</em>: if the command is expecting a number, we can't give it a list for instance.</p>
<p>Here is the list of all types and how they are written:</p>
<pre><code class="language-hydre"># Booleans (bool) (`true` or `false`)
_ = true

# Integers (int)
_ = 3

# Floating-point numbers (float)
_ = 3.14

# Characters (char)
_ = 'a'

# Strings (string)
_ = &quot;abc&quot;

# Lists of a given type (list[type])
_ = [ 3, 3.14 ]

# Maps (key-values) (map[key_type, value_type])
_ = { &quot;a&quot;: 1, &quot;b&quot;: 2 }

# Paths (path) - must contain at least one `/` to indicate clearly that it's a path and not a string or something else
_ = dir/file.ext
_ = ./file.ext
_ = /tmp

# Commands (used to run custom commands later in functions)
_ = @{ command &quot;pos1&quot; -s --long }
</code></pre>
<p>A <code>string</code> is composed of multiple <code>char</code>s, which are made of single codepoints. This means a <em>grapheme cluster</em> made of multiple codepoints will need to be encoded in a <code>string</code>.<br />
There is also the <code>any</code> type which accepts values of all types, and <code>stream</code> which we'll talk about later as it's a special type.<br />
Finally, there is the <code>void</code> type which cannot be written 'as is' but is used in special contexts like <a href="#commands-typing">commands return values</a>. It's a type that contains no data at all.</p>
<p>There are also <em>flag arguments</em>, which are dash arguments that take no value. The command will simply check if the argument was provided or not.</p>
<p><strong>NOTE:</strong> In order to avoid writing errors, positional arguments cannot be provided after a flag argument.</p>
<p>For instance, considering <code>pos1</code> and <code>pos2</code> are positional arguments, <code>--flag</code> a flag argument and <code>--val</code> a non-flag long argument:</p>
<pre><code class="language-hydre"># VALID
command &quot;pos1&quot; &quot;pos2&quot; --flag --val 2

# VALID
command &quot;pos1&quot; --val 2 &quot;pos2&quot; --flag

# VALID
command &quot;pos1&quot; --flag --val 2 &quot;pos2&quot;

# VALID
command --flags --val 2 &quot;pos1&quot; &quot;pos2&quot;

# INVALID (we could think by reading this that &quot;pos2&quot; is the
#          value of the non-flag argument &quot;--flag&quot;)
command &quot;pos1&quot; --flag &quot;pos2&quot; --val 2
</code></pre>
<h3 id="variables-shadowing"><a class="header" href="#variables-shadowing">Variables shadowing</a></h3>
<p>Any variable can, inside a program, be replaced by a new variable with a same name but with a different type. This is called <em>shadowing</em>.</p>
<p>It can be useful when converting data from a type to another, such as:</p>
<pre><code class="language-hydre">var names: list[string] = [ &quot;Jack&quot;, &quot;John&quot; ]

var names: string = names.join(&quot;,&quot;) # this is called a _method_, we'll talk about them later
</code></pre>
<p>Here, we <em>shadowed</em> the <code>names</code> variable to create a new one with a different type from the data we had before, which means we cannot access the original <code>names</code> variable anymore.</p>
<h2 id="expressions"><a class="header" href="#expressions">Expressions</a></h2>
<p>To use a variable, we can directly use it like this::</p>
<pre><code class="language-hydre">tellage ${age}
</code></pre>
<p>So this code:</p>
<pre><code class="language-hydre">var age = 20
tellage ${age}
</code></pre>
<p>Is equivalent to this one:</p>
<pre><code class="language-hydre">tellage 20
</code></pre>
<p>It's also possible to perform computations using expressions:</p>
<pre><code class="language-hydre">var age = 20
var add = 12
tellage ${age + add}
</code></pre>
<p>String and characters can also be inserted inside a string:</p>
<pre><code class="language-hydre">var name = &quot;Jack&quot;
echo &quot;Hello, ${name}!&quot; # Hello, Jack!
</code></pre>
<p>Values in lists through their index (starting at 0):</p>
<pre><code class="language-hydre">var names = [ &quot;Jack&quot; ]
echo &quot;Hello, ${names[0]}!&quot; # Hello, Jack!
</code></pre>
<p>Values in maps through their key:</p>
<pre><code class="language-hydre">var ages = { &quot;Jack&quot;: 28 }

echo &quot;Jack is ${ages[&quot;Jack&quot;]} years old!&quot;
</code></pre>
<p>Note that getting an out-of-bound index will make the program <em>panic</em>, which means it exits immediatly with an error message.</p>
<pre><code class="language-hydre">var names = [ &quot;Jack&quot; ]
echo &quot;Hello, ${names[1]}!&quot; # Panics
</code></pre>
<h2 id="computing-values"><a class="header" href="#computing-values">Computing values</a></h2>
<p>It's also possible to compute values using operators. Each operator takes one or multiple operands, which can be either a variable or a literal value.</p>
<h3 id="mathematical-operators"><a class="header" href="#mathematical-operators">Mathematical operators</a></h3>
<p>Mathematical operators all take two operands. If any of the operands is not a number, it will fail.
If both operands are integers, the result will be an integer, but if at least one is a floating-point number, so will be the result.</p>
<p>The operators are:</p>
<ul>
<li><code>+</code>: addition</li>
<li><code>-</code>: substraction</li>
<li><code>*</code>: multiplication</li>
<li><code>**</code>: pow</li>
<li><code>/</code>: division</li>
<li><code>//</code>: floating-point division (gives a floating-point number even if the two operands are integers)</li>
<li><code>%</code>: remainder (works only with two integers)</li>
</ul>
<h3 id="bit-wise-operators"><a class="header" href="#bit-wise-operators">Bit-wise operators</a></h3>
<p>Bit-wise operators only take integer operands and produce an integer result:</p>
<ul>
<li><code>&amp;</code> bit-by-bit and</li>
<li><code>|</code> bit-by-bit or</li>
<li><code>^</code> bit-by-bit exclusive or</li>
<li><code>&lt;&lt;</code> binary left shift operator</li>
<li><code>&gt;&gt;</code> binary right shift operator</li>
<li><code>~</code> one's complement - takes a single number</li>
</ul>
<h3 id="logical-operators"><a class="header" href="#logical-operators">Logical operators</a></h3>
<p>Logical operators take two operands and return a boolean:</p>
<table><thead><tr><th>Symbol</th><th>Name</th><th>Returns <code>true</code> if...</th></tr></thead><tbody>
<tr><td><code>&amp;&amp;</code></td><td>and</td><td><code>a</code> and <code>b</code> are <code>true</code> booleans</td></tr>
<tr><td><code>\|\|</code></td><td>or</td><td><code>a</code>, <code>b</code> or both are <code>true</code> booleans</td></tr>
<tr><td><code>==</code></td><td>equal to</td><td><code>a</code> is equal to <code>b</code></td></tr>
<tr><td><code>!=</code></td><td>different than</td><td><code>a</code> is different than <code>b</code></td></tr>
<tr><td><code>&gt;</code></td><td>greater than</td><td><code>a</code> is greater than <code>b</code></td></tr>
<tr><td><code>&lt;</code></td><td>lower than</td><td><code>a</code> is lower than <code>b</code></td></tr>
<tr><td><code>&gt;=</code></td><td>greater than or equal to</td><td><code>a</code> is greater than or equal to <code>b</code></td></tr>
<tr><td><code>&lt;=</code></td><td>lower than or equal to</td><td><code>a</code> is lower than or equal to <code>b</code></td></tr>
</tbody></table>
<p>Finally, there is the <code>!</code> operator, which takes a single operand on its right, and simply reverts a boolean.</p>
<h3 id="assignment-operators"><a class="header" href="#assignment-operators">Assignment operators</a></h3>
<p>The neutral assignment operator <code>=</code> can be prefixed by any mathematical, bit-wise or logical operator's symbol(s). The operator's left operand will be the current variable's content, while the right one will be the value on the left of the assignment operator. The result will then be stored in the variable.</p>
<p>Here is an example:</p>
<pre><code class="language-hydre">var a = 3

a += 1
a *= 8
a /= 2

echo ${a} # 16
</code></pre>
<p>Note that the result's type must be compatible with the variable:</p>
<pre><code class="language-hydre">var a = 0

a &amp;&amp;= 1 # ERROR: Cannot assign a 'bool' to an 'int'
</code></pre>
<p>There are also the <code>++</code> and <code>--</code> operators, which respectively increase and decrease the desired variable:</p>
<pre><code class="language-hydre">var a = 0

a ++
a ++
a --

echo ${a} # 1
</code></pre>
<h2 id="lists-and-maps"><a class="header" href="#lists-and-maps">Lists and maps</a></h2>
<p>Lists and maps behave in a similar way: while lists have <em>indexes</em>, which are handled behind-the-scenes, maps have <em>keys</em>, which are provided explicitly.</p>
<p>Here is how we declare a list or a map:</p>
<pre><code class="language-hydre"># Type: list[string]
var names = [ &quot;Jack&quot;, &quot;John&quot; ]

# Type: map[string, int]
var ages = { &quot;Jack&quot;: 28, &quot;John&quot;: 29 }
</code></pre>
<p>To add a new value:</p>
<pre><code class="language-hydre"># Lists
names[] = &quot;Paolo&quot;

# Maps
ages[&quot;Paolo&quot;] = 26
</code></pre>
<p>To get a value:</p>
<pre><code class="language-hydre"># Type: int
names[0]

# Type: int
ages[&quot;Paolo&quot;]
</code></pre>
<p>To remove a value:</p>
<pre><code class="language-hydre"># Lists
delete names[0]

# Maps
delete ages[&quot;Paolo&quot;]
</code></pre>
<p>To get the number of entries:</p>
<pre><code class="language-hydre"># Type: int
names.len()

# Maps: int
ages.count()
</code></pre>
<h2 id="blocks"><a class="header" href="#blocks">Blocks</a></h2>
<p>Blocks allow to run a piece of code multiple times or if a specific condition is met. They are useful combined to comparison operators.</p>
<h3 id="conditionals"><a class="header" href="#conditionals">Conditionals</a></h3>
<p>Conditionals uses the following syntax:</p>
<pre><code class="language-hydre">if # condition
  command1
end
</code></pre>
<p>When this block is ran, if <code>condition</code> (which is an expression that must result in a boolean) is equal to <code>true</code>, <code>command1</code> is ran. Here is an example:</p>
<pre><code class="language-hydre">if 2 + 2 == 4
  command1
end
</code></pre>
<p>It's possible to specify multiple commands at once:</p>
<pre><code class="language-hydre">if 2 + 2 == 4
  command1
  command2
  command3
end
</code></pre>
<p>Note that all commands must be indented by one tabulation.</p>
<p>It's also possible to run a set of commands in case the condition isn't met too using <code>else</code>:</p>
<pre><code class="language-hydre">if 2 + 2 == 4
  command1
else
  command2
end
</code></pre>
<p>Finally, conditions can be chained using <code>elif</code>:</p>
<pre><code class="language-hydre">if 1 + 1 == 4
  echo &quot;Bizarre.&quot;
elif 1 + 1 == 3
  echo &quot;Bizarre!&quot;
else
  echo &quot;Normal.&quot;
end
</code></pre>
<h3 id="switches"><a class="header" href="#switches">Switches</a></h3>
<p>A <em>switch</em> allows to perform actions depending on a value. It's roughly equivalent to a combination of multiple <code>if</code> and <code>elif</code> statements.</p>
<pre><code class="language-hydre">switch rand_int(0, 10)
  when 0
    echo &quot;It's zero!&quot;

  when 1
    echo &quot;It's one!&quot;

  else
    echo &quot;It's something else&quot;
end
</code></pre>
<p>Note that, for blocks that only contain a single instruction, we can shorten this using the following syntax:</p>
<pre><code class="language-hydre">switch rand_int(0, 10)
  when 0 =&gt; echo &quot;It's zero!&quot;
  when 1 =&gt; echo &quot;It's one!&quot;
  else   =&gt; echo &quot;It's something else!&quot;
end
</code></pre>
<h3 id="loops"><a class="header" href="#loops">Loops</a></h3>
<p>Loops allow to run a piece of code for a while. The most common loop is the range loop:</p>
<pre><code class="language-hydre">for i in 0..10
  command ${i}
end
</code></pre>
<p>This will run <code>command 0</code> to <code>command 9</code>. To include the upper bound, we must add an <code>=</code> symbol:</p>
<pre><code class="language-hydre">for i in 0..=10
  command ${i}
end
</code></pre>
<p>This will run <code>command 0</code> to <code>command 10</code>.</p>
<p>We can also iterate on a list:</p>
<pre><code class="language-hydre">var str = &quot;Jack&quot;

var list = [ &quot;Jack&quot;, &quot;John&quot; ]

for name in list
  echo ${name}
end
</code></pre>
<p>This will display <code>Jack</code> and <code>John</code>.</p>
<p>To get the indexes as well, we can do:</p>
<pre><code class="language-hydre">for i, name in list
  echo &quot;${i}: ${name}&quot;
end
</code></pre>
<p>This will display <code>0: Jack</code> and <code>1: John</code>.</p>
<p>For maps:</p>
<pre><code class="language-hydre">var ages = { &quot;Jack&quot;: 28, &quot;John&quot;: 29 }

for name, age in ages
  echo &quot;${name} is ${age} years old!&quot;
end
</code></pre>
<p>There is another type of loop, which runs a piece of code while a condition is met:</p>
<pre><code class="language-hydre">while # condition
  command
end
</code></pre>
<p>If the <code>condition</code> is <code>false</code> when the loop is reached, the <code>command</code> will not be ran once. Else, it will be ran as long as the <code>condition</code> is <code>true</code>.</p>
<p>Note that loops can be broke anytime using the <code>break</code> keyword:</p>
<pre><code class="language-hydre">for i in 0..10
  command ${i}

  if i == 2
    break
  end
end
</code></pre>
<p>This will run <code>command 0</code>, <code>command 1</code> and <code>command 2</code> only.</p>
<h3 id="filesystem-iteration"><a class="header" href="#filesystem-iteration">Filesystem iteration</a></h3>
<p>It's possible to iterate on a list of files and directories:</p>
<pre><code class="language-hydre">for file in (./*.txt)
  echo &quot;Found a text file: ${file}&quot;
end
</code></pre>
<p>The pattern between parenthesis must be a glob pattern. Recursivity is supported to:</p>
<pre><code class="language-hydre">for file in (**/*.txt)
  echo &quot;Found a text file: ${file}&quot;
end
</code></pre>
<h3 id="variables-scoping"><a class="header" href="#variables-scoping">Variables scoping</a></h3>
<p>When a variable is declared, it is <em>scoped</em> to the current block, meaning it doesn't exist outside of the current block:</p>
<pre><code class="language-hydre"># This variable is declared in the &quot;global&quot; block
# so it's available everywhere in the current script
var firstName = &quot;Jack&quot;

if firstName == &quot;Jack&quot;
  # This variable is declared in an &quot;if&quot; block
  # so it's not available outside of it
  var lastName = &quot;Sparrow&quot;
end

echo ${firstName} # Prints: &quot;Jack&quot;
echo ${lastName} # ERROR (&quot;lastName&quot; is not in scope)
</code></pre>
<p>Also, variables are not shared between scripts.</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<p>Functions allow to split the code in several parts to make it more readable, as well as to re-use similar pieces of code across the script.</p>
<pre><code class="language-hydre">fn hello()
  echo &quot;Hello!&quot;
end
</code></pre>
<p>Now we can call <code>hello</code> this way:</p>
<pre><code class="language-hydre">hello() # Will print &quot;Hello !&quot;
</code></pre>
<h3 id="arguments"><a class="header" href="#arguments">Arguments</a></h3>
<p>Function can also take arguments, which must have a type.</p>
<pre><code class="language-hydre">fn hello (name: string)
  echo &quot;Hello, ${name}!&quot;
end

hello(&quot;Jack&quot;) # Will print &quot;Hello, Jack!&quot;
</code></pre>
<p>Arguments can be made optional by providing default values. This also allows to get rid of their explicit type as it's now implicit:</p>
<pre><code class="language-hydre">fn hello (name = &quot;Unknown&quot;)
  echo &quot;Hello, ${name}!&quot;
end

hello()       # Will print &quot;Hello, Unknown!&quot;
hello(&quot;Jack&quot;) # Will print &quot;Hello, Jack!&quot;
</code></pre>
<p>Note that a function's arguments do not require to wrap the value between <code>${...}</code> as it's implicit. Which means we can write:</p>
<pre><code class="language-hydre">var name = &quot;Jack&quot;
hello(name) # Prints: &quot;Hello, Jack!&quot;
</code></pre>
<p>We can also combine functions and blocks, for instance:</p>
<pre><code class="language-hydre">fn greet (names: list[string]) -&gt; int
  # .len() is called an _extension_, we will see more about that later
  if names.len() == 0
    echo &quot;No one to greet :|&quot;
  else
    for name in names
      echo &quot;Hello, ${name}!&quot;
    end
  end
end

hello([])               # No one to greet :|
hello([&quot;John&quot;, &quot;Jack&quot;]) # Hello, John! Hello, Jack!
</code></pre>
<h3 id="return-types"><a class="header" href="#return-types">Return types</a></h3>
<p>Functions can also return values. In such case, they must specify the type of values they return, and ensure all code paths will return a value of this type:</p>
<pre><code class="language-hydre">fn add (a: float, b: float) -&gt; float
  return a + b
end
</code></pre>
<h3 id="methods"><a class="header" href="#methods">Methods</a></h3>
<p>All value types expose specific functions that can be used with a dot after a variable of the given type, called <em>methods</em>:</p>
<pre><code class="language-hydre">var letters = &quot;abcdef&quot;
var letters = letter.split(&quot;,&quot;)
</code></pre>
<p>Here, we use the <code>split</code> <em>method</em> of the <code>string</code> type, which returns a <code>list[string]</code>.</p>
<h3 id="failing"><a class="header" href="#failing">Failing</a></h3>
<p>Functions can also <em>fail</em> to indicate something went wrong:</p>
<pre><code class="language-hydre">fn divide (a: float, b: float) -&gt; fallible float
  if b == 0
    fail &quot;Cannot divide by 0!&quot;
  else
    return a / b
  end
end
</code></pre>
<p>The <code>fallible</code> keyword must be present before the return type to indicate the function may fail (even if the function doesn't return anything).</p>
<p>When a function fails, the program stops and print the provided error message. But it's also possible to handle the error:</p>
<pre><code class="language-hydre">fn handle_bad_div (a: float, b: float) -&gt; float
  catch divide(a, b)
    ok result
      echo &quot;Divided successfully: ${a} / ${b} = ${result}&quot;

    err errmsg
      echo &quot;Division failed :(&quot;
      echo &quot;Here is the error message: ${errmsg}&quot;
  end
end
</code></pre>
<p>Note that you may handle only the success or error case depending on your needs ; you do not have to handle both cases.</p>
<p>This keyword also allows to catch errors from commands:</p>
<pre><code class="language-hydre"># Run a command and get error messages from CMDERR instead if the command fails
catch $(somecommand)
  ok data =&gt; echo &quot;Success: ${data}&quot;
  err msg =&gt; echo &quot;Errors: ${msg.join(&quot;; &quot;)}&quot;
end
</code></pre>
<h4 id="retries"><a class="header" href="#retries">Retries</a></h4>
<p>It's possible to retry a function until it succeeds using the <code>retry</code> keyword:</p>
<pre><code class="language-hydre">fn may_fail ()
  if rand() &gt; 0.5
    fail &quot;I don't like high numbers&quot;
  end
end

retry may_fail()
</code></pre>
<p>This will run <code>may_fail</code>, and run it again if it fails, until it succeeds.</p>
<p>It's also possible to specify a maximum  of retries:</p>
<pre><code class="language-hydre">retry(5) may_fail()
</code></pre>
<p>For information, here is the declaration of the native <code>retry_cmd</code> command, which allows to try to run a command until it succeeds:</p>
<pre><code class="language-hydre">fn retry_cmd(cmd: command, retries: string) -&gt; fallible
  retry(retries) cmd()
  if status() != 0
    fail &quot;Command did not suceed after ${retries} retries.&quot;
  end
end
</code></pre>
<p>It can be used like this:</p>
<pre><code class="language-hydre">retry_cmd(@{ read &quot;file.txt&quot; }, 10)
</code></pre>
<h4 id="global-failing"><a class="header" href="#global-failing">Global failing</a></h4>
<p>A whole script can fail using this keyword, which will result in displaying the error message in CMDERR and exiting immediatly.<br />
The failure may be handled using <code>fallible</code> in the caller script.</p>
<h2 id="nullable-types"><a class="header" href="#nullable-types">Nullable types</a></h2>
<p>Sometimes, it's useful to be able to represent a value that may be either <em>something</em> or <em>nothing</em>. In many programming languages, &quot;nothing&quot; is represented as the <code>null</code>, <code>nil</code> or <code>()</code> value.</p>
<p>Nullable types are suffixed by a <code>?</code> symbol, and may either contain a value of the provided type <strong>or</strong> <code>null</code>. Here is an example:</p>
<pre><code class="language-hydre">fn custom_rand() -&gt; int?
  var rnd = rand_int(-5, 5)

  if rnd &gt; 0
    return rnd
  else
    return null
  end
end
</code></pre>
<p>To declare a variable with an nullable type, we wrap its initialization value in the nullable operator <code>?(...)</code>:</p>
<pre><code class="language-hydre">var a = 1 # int
var b = ?(1) # int?
</code></pre>
<p>Or we explicitly give the variable a nullable type:</p>
<pre><code class="language-hydre">var b: int? = 1 # int?
</code></pre>
<p>To initialize the variable with the <code>null</code> value instead, we must use the explicit version:</p>
<pre><code class="language-hydre">var c: int? = null # int?
</code></pre>
<p>Note that imbricated types are not supported, which means we cannot create <code>int??</code> values for instance.</p>
<h3 id="handle-the-null-value"><a class="header" href="#handle-the-null-value">Handle the <code>null</code> value</a></h3>
<p>If we try to access an nullable value &quot;as is&quot;, we will get a type error:</p>
<pre><code class="language-hydre">var a = ?(1)

var b = 0
b = a # ERROR: Cannot use an `int?` value where `int` is expected
</code></pre>
<p>We then have multiple options. We can use one of the nullable types' function:</p>
<pre><code class="language-hydre">var a = ?(1)

var b = 0

# Make the program exit with an error message if 'a' is null
b = a.unwrap()

# Make the program exit with a custom error message if 'a' is null
b = a.expect(&quot;'a' should not be null :(&quot;)
</code></pre>
<p>We can also detect if a value is <code>null</code> by using the <code>.isNull()</code> method:</p>
<pre><code class="language-hydre">var a = ?(1)
var b: int? = null

echo ${a.isNull()} # false
echo ${b.isNull()} # true
</code></pre>
<p>There is also the <code>.default(T)</code> method that allows to use a fallback value in case of <code>null</code>:</p>
<pre><code class="language-hydre">var a = ?(1)
var b: int? = null

echo ${a.default(3)} # 1
echo ${b.default(3)} # 3
</code></pre>
<p>We can also use special syntaxes in blocks:</p>
<pre><code class="language-hydre">var a = ?(1)

if some a
  # While we are in this block, 'a' is considered as an 'int'
else
  # While we are in this block, 'a' is considered as 'null'
end

while some a
  # Same here
end
</code></pre>
<p>Also, if the program exits in all cases when the argument is considered as null or non-null, the opposite type will be applied to the rest of the program:</p>
<pre><code class="language-hydre">var a = ?(1)

if some a
  exit
end

# 'a' is considered as 'null' here

var b = ?(1)

if none b
  exit
end

# 'b' is considered as 'int' here
</code></pre>
<h3 id="the-case-of-optional-arguments"><a class="header" href="#the-case-of-optional-arguments">The case of optional arguments</a></h3>
<p>When a command takes an optional argument, it's possible to provide a nullable value of the same type instead:</p>
<pre><code class="language-hydre">var no_newline = ?(false)

echo &quot;Hello!&quot; -n ${no_newline}
</code></pre>
<p>If the value is <code>null</code>, the argument will not be provided. Else, it will be provided with the non-null value.</p>
<h3 id="nullable-any"><a class="header" href="#nullable-any">Nullable <code>any</code></a></h3>
<p>The <code>any</code> type covers any type of values, meaning it accepts absolutely every single value, <em>except</em> the <code>null</code> value. Indeed, <code>any</code> is not nullable by default, so to make it accept <code>null</code> values we must use <code>any?</code> instead.</p>
<h2 id="advanced-types"><a class="header" href="#advanced-types">Advanced types</a></h2>
<h3 id="structures"><a class="header" href="#structures">Structures</a></h3>
<p><em>Structures</em> map one or multiple <em>fields</em> to as many <em>values</em>. Here is an example:</p>
<pre><code class="language-hydre">fn sayHello(person: struct { firstName: string, lastName: string })
  echo &quot;Hello, ${person.firstName} ${person.lastName}!&quot;
end

sayHello({ firstName: &quot;Bat&quot;, lastName: &quot;Man&quot; }) # Prints: &quot;Hello, Bat Man!&quot;
</code></pre>
<p>In such a simple example, it's easier to directly use a <code>firstName</code> and <code>lastName</code> parameters instead of a <code>struct</code>, but they are useful when returning heterogenous sets of data, for example in a list:</p>
<pre><code class="language-hydre">fn listRecursively(dir: path) -&gt; list[struct { name: path, size: int }]
  var list: list[struct { name: path, size: int }] = []

  for item in $(ls ${dir} --details)
    if item.isDirectory
      listRecursively(dir)
    else
      list[] = { name: item.path, size: stats.sizeOf }
    end
  end

  return list
end
</code></pre>
<p>But, as this is not very readable, it's better to use a <em>type alias</em>:</p>
<pre><code class="language-hydre">type fsItem = struct { name: path, size: int }

fn listRecursively(dir: path) -&gt; list[fsItem]
  var list: list[fsItem] = []
  # ...
end
</code></pre>
<h3 id="closures"><a class="header" href="#closures">Closures</a></h3>
<p>Closures are anonymous functions which are generally used to repeat the same group of operations.</p>
<pre><code class="language-hydre">var test: fn (string, int) = { a, b -&gt; echo &quot;${a.repeat(b)}&quot; }
test(&quot;Hello world! &quot;, 3) # Prints: &quot;Hello world! Hello world! Hello world! &quot;
</code></pre>
<p>Note that closures can also return values implicitly:</p>
<pre><code class="language-hydre">var test: fn (string, int) -&gt; string = { a, b -&gt; a.repeat(b) }
echo ${test(&quot;Hello world!&quot;, 3)} # Prints: &quot;Hello world! Hello world! Hello world! &quot;
</code></pre>
<p>Also, closures are not forced to take their declared parameters:</p>
<pre><code class="language-hydre">type testType = fn (string, int)

var test: testType = { a, b, c -&gt; ### ... ### } # NOT VALID
var test: testType = { a, b    -&gt; ### ... ### } # Valid
var test: testType = { a       -&gt; ### ... ### } # Valid
var test: testType = {         -&gt; ### ... ### } # Valid
</code></pre>
<p>Here is a concrete usage example:</p>
<pre><code class="language-hydre">fn forEachFile(dir: path, callback: fn (path))
  for item in $(ls ${dir} --details)
    if item.isFile
      callback(item.fullPath)
    end
  end
end

forEachFile(./, { file -&gt; echo &quot;File: ${file}&quot; })
</code></pre>
<h3 id="streams"><a class="header" href="#streams">Streams</a></h3>
<p>An usual type for manipulating large data is <code>stream</code>, which is notably used to treat a chunk of data that is either too large for the memory or is more easier to treat as things progress.</p>
<h2 id="data-validation"><a class="header" href="#data-validation">Data validation</a></h2>
<p>Some commands may return a value whose type cannot be predicted before runtime. For instance, a command fetching a JSON object from a remote server will, in case of success, return a value but whose type cannot be known beforehand.</p>
<p><em>Data validation</em> is a feature allowing to scripts to check the type of an unknown value at runtime, using <em>type assertions</em>.</p>
<p>Here is an example:</p>
<pre><code class="language-hydre">var test: any = [ 2, 3, 4 ]

# 1. Here, &quot;test&quot; is considered to be of type &quot;any&quot;

if test is list[int]
  # 2. Here, &quot;test&quot; is considered to be of type &quot;list[int]&quot;
else
  # 3. Here, &quot;test&quot; is considered to be of type &quot;any&quot;
end
</code></pre>
<p>The <code>isnt</code> keyword can also be used:</p>
<pre><code class="language-hydre">var test: any = [ 2, 3, 4 ]

# 1. Here, &quot;test&quot; is considered to be of type &quot;any&quot;

if test isnt list[int]
  # 2. Here, &quot;test&quot; is considered to be of type &quot;any&quot;
else
  # 3. Here, &quot;test&quot; is considered to be of type &quot;list[int]&quot;
end
</code></pre>
<p>If, in an &quot;isnt&quot; conditional, the script exits/fails in all cases (or returns if we're in a function), the value is considered with the asserted type for the rest of the script:</p>
<pre><code class="language-hydre">var test: any = [ 2, 3, 4 ]

# 1. Here, &quot;test&quot; is considered to be of type &quot;any&quot;

if test isnt list[int]
  # 2. Here, &quot;test&quot; is considered to be of type &quot;any&quot;
  exit
end

# 3. Here, &quot;test&quot; is considered to be of type &quot;list[int]&quot;
# &gt; Because it's impossible for &quot;test&quot; to not be &quot;list[int]&quot; as in that case the program would have exited
</code></pre>
<p>This can be used to check complex structures as well:</p>
<pre><code class="language-hydre"># Considering we have a `fn fetchJson(url: string) -&gt; any' function that fetches a JSON value from the web

type User = struct { id: int, firstName: string, lastName: string, email: string }

var json = fetchJson(&quot;https://mysuperapi.../users/all&quot;)

if json isnt User
  fail &quot;JSON doesn't have the correct structure&quot;
end

# &quot;json&quot; is considered as a &quot;User&quot; here
</code></pre>
<h2 id="event-listeners"><a class="header" href="#event-listeners">Event listeners</a></h2>
<p>Scripts can listen to events using the <code>on</code> keyword:</p>
<pre><code class="language-hydre">on keypress as keycode
  echo &quot;A key was pressed: ${keycode}&quot;
end
</code></pre>
<p>This program will display a message each time a key is pressed.</p>
<p>If the event listener is registered in a function, the is automatically unregistered when that function returns. If it's registered outside a function, it is unregistered when the script ends.</p>
<pre><code class="language-hydre">fn test()
  on keypress as keycode # (1)
    # Do something
  end
  # Event listener (1) is unregistered here
end

on keypress as keycode # (2)
  # Do something
end

echo &quot;Hello world!&quot;
# Event listener (2) is unregistered here
</code></pre>
<h3 id="waiting"><a class="header" href="#waiting">Waiting</a></h3>
<p>Scripts may wait for a specific event before continuing. This can be achieved without a <code>while</code> loop that consumes a lot of CPU, using the <code>wait</code> keyword:</p>
<pre><code class="language-hydre">wait condition
</code></pre>
<p>The script will block while the provided <code>condition</code> is not <code>true</code>. The checking interval is defined by the system, and the condition should as fast to check as possible to consume as little CPU as possible.</p>
<pre><code class="language-hydre">echo &quot;Please press the &lt;F&gt; key to validate your choice&quot;

var validated = false

on keypress as keycode
  if keycode == KEY_F
    validated = true
  end
end

wait validated

echo &quot;Thanks for validating your choice :D&quot;
</code></pre>
<p>It's also possible to wait for a variable to not be <code>null</code>:</p>
<pre><code class="language-hydre">echo &quot;Please press a key&quot;

var key: int? = null

on keypress as keycode
  key = keycode
end

wait some key

echo &quot;You pressed key: ${key}&quot;
</code></pre>
<h2 id="imports"><a class="header" href="#imports">Imports</a></h2>
<p>As you may already know, command names can be <a href="../concepts/applications.html#commands">quite long and complicated</a>. In order to prevent from having to repeat very long names that are not really readable, it's recommanded to use <em>imports</em> which are declared at the beginning of script with the form <code>&lt;dev&gt;::&lt;app&gt;::&lt;command&gt;</code>:</p>
<pre><code class="language-hydre">import system::fs::read_file

read_file # ...
</code></pre>
<p>It's then possible to use the <code>read_file</code> without prefixing.</p>
<p>To perform multiple imports at once:</p>
<pre><code class="language-hydre">import system::fs::{read_file, write_file}
</code></pre>
<p>It's also possible to only bind the application itself:</p>
<pre><code class="language-hydre">import system::fs

fs::read_file # ...
</code></pre>
<h3 id="aliases"><a class="header" href="#aliases">Aliases</a></h3>
<p>Imported commands can also be aliased:</p>
<pre><code class="language-hydre">import system::fs as sysfs

sysfs::read_file # ...
</code></pre>
<h3 id="import-expansions"><a class="header" href="#import-expansions">Import expansions</a></h3>
<p>It's possible to import all commands from an application, with:</p>
<pre><code class="language-hydre">import system::fs::*

read_file # ...
</code></pre>
<p>But also to import all applications from a developer, with:</p>
<pre><code class="language-hydre">import system::*

fs::read_file # ...
</code></pre>
<p>Note that, if a name clash occurs - if two applications or commands with the same name are imported -, the script won't be able to run.</p>
<h3 id="non-clashing-namespace"><a class="header" href="#non-clashing-namespace">Non-clashing namespace</a></h3>
<p>The <em>non-clashing namespace</em> is a namespace that can be imported, where live all commands whose name is unique across all applications.</p>
<p>For instance, let's imagine we have two applications:</p>
<ul>
<li><code>AppA</code> by <code>DevA</code>, which exposes a <code>cmd_a</code> and a <code>cmd_z</code> command ;</li>
<li><code>AppB</code> by <code>DevB</code>, which exposes a <code>cmd_b</code> and a <code>cmd_z</code> command</li>
</ul>
<p>What happens here? While the <code>cmd_z</code> command has a name clash between <code>AppA</code> and <code>AppB</code>, the <code>cmd_a</code> and <code>cmd_b</code> commands don't. This results in these last two commands being also put in the <code>nonclashing</code> namespace, which can then be imported like a traditional application:</p>
<pre><code class="language-hydre">import shell::nonclashing

nonclashing::cmd_a # OK
nonclashing::cmd_b # OK
nonclashing::cmd_z # ERROR (not in namespace)
</code></pre>
<p>This means we can also import all commands that don't clash with other ones:</p>
<pre><code class="language-hydre">import shell::nonclashing::*

cmd_a # OK
cmd_b # ...
cmd_z # ERROR (not in namespace)
</code></pre>
<h3 id="volatile-imports"><a class="header" href="#volatile-imports">Volatile imports</a></h3>
<p>As <a href="../concepts/applications.html#volatile-applications">volatile applications</a>' commands <a href="applications.html#volatile-applications">are not exposed globally</a>, there is a special import syntax for such applications, allowing to import their commands directly from their <a href="applications.html#application-package">application package</a>:</p>
<pre><code class="language-hydre">import ./app.nva::super_command
super_command # ...

# OR
import ./app.nva as app
app::super_command # ...
</code></pre>
<h2 id="commands-input--output"><a class="header" href="#commands-input--output">Commands input &amp; output</a></h2>
<h3 id="reading-a-commands-output"><a class="header" href="#reading-a-commands-output">Reading a command's output</a></h3>
<p>Commands output data through <em>pipes</em>. There are several output pipes that can be used:</p>
<ul>
<li>CMDOUT is the default output pipe, which returns typed values (the command declares its output type beforehand)</li>
<li>CMDRAW allows to send a <code>stream</code>, which is useful when dealing with a lot of data or with external data</li>
<li>CMDMSG allows to send <code>string</code> messages that are displayed in the terminal's windows</li>
<li>CMDERR allows to send <code>string</code> messages that are also displayed, but as error messages</li>
</ul>
<p>There is a specific syntax to get the output from each pipe. To get the (typed) output from CMDOUT:</p>
<pre><code class="language-hydre">_ = $(echo &quot;Hello!&quot;) # Contains: &quot;Hello!&quot;
</code></pre>
<p>This is called the <em>typed reception operator</em>. It can be used like this for instance:</p>
<pre><code class="language-hydre">echo ${$(echo &quot;Hello!&quot;)} # Prints: &quot;Hello!&quot;
</code></pre>
<p>But, as this syntax is not very readable, evaluating a single command can be made without the <code>${...}</code> expression wrapper:</p>
<pre><code class="language-hydre">echo $(echo &quot;Hello!&quot;) # Prints: &quot;Hello!&quot;
</code></pre>
<p>Note that this only work if the command supports piping through CMDOUT.</p>
<p>To get the result from CMDRAW instead (as a <code>stream</code>), if the command supports it:</p>
<pre><code class="language-hydre"># '-b' makes 'echo' read from a stream
echo -b $@(streamify &quot;Hello!&quot;) # Prints: &quot;Hello!&quot;
</code></pre>
<p>To get the output of CMDMSG instead (as a <code>list[string]</code>):</p>
<pre><code class="language-hydre">echo $?(echo &quot;Hello!&quot;) # Prints: &quot;[&quot;Hello!&quot;]&quot;
</code></pre>
<p>To get the output of CMDERR (as a <code>list[string]</code>):</p>
<pre><code class="language-hydre">echo $!(echo &quot;Hello!&quot;) # Prints &quot;[]&quot;
</code></pre>
<p>To get the combined output of CMDMSG and CMDERR (as a <code>list[string]</code>):</p>
<pre><code class="language-hydre">echo $*(echo &quot;Hello!&quot;) # Prints &quot;[&quot;Hello!&quot;]&quot;
</code></pre>
<p>Note that using the <code>$(...)</code> operator will make the program panic if the command exits with a non-zero status code.</p>
<h3 id="redirecting-the-output-to-a-file"><a class="header" href="#redirecting-the-output-to-a-file">Redirecting the output to a file</a></h3>
<p>It's also possible to redirect the output of a command to a file, using the <code>&gt;</code> operator. The values are converted to strings before being written, except <code>stream</code> values which are written as they are.</p>
<pre><code class="language-hydre">echo &quot;Hello!&quot; &gt; ./test.txt
</code></pre>
<p>This works because <code>echo</code> outputs by default to CMDOUT, not to CMDMSG. If it did, we could still perform the redirection this way:</p>
<pre><code class="language-hydre">echo &quot;Hello!&quot; ?&gt; ./test.txt
</code></pre>
<p>The prefixes are the same as for the <code>$(...)</code> operator:</p>
<ul>
<li><code>&gt;</code> for CMDOUT</li>
<li><code>@&gt;</code> for CMDRAW</li>
<li><code>?&gt;</code> for CMDMSG</li>
<li><code>!&gt;</code> for CMDERR</li>
<li><code>*&gt;</code> for CMDMSG and CMDERR combined</li>
</ul>
<h3 id="output-data"><a class="header" href="#output-data">Output data</a></h3>
<p>If a script is <a href="#commands-typing">declared as a command</a>, it gets its own CMDIN, CMDOUT and CMDRAW pipes (the CMDUSR, CMDMSG and CMDERR pipes remain as usual).</p>
<p>They can be accessed using three built-in commands: <code>cmdin</code>, <code>cmdout</code> and <code>cmdraw</code>.</p>
<h4 id="reading-from-cmdin"><a class="header" href="#reading-from-cmdin">Reading from CMDIN</a></h4>
<p>The <code>cmdin</code> command simply writes in its CMDOUT the value provided in the shell's CMDIN. For instance:</p>
<pre><code class="language-hydre"># Considering this shell script accepts `string` values as input.

# If this shell script is called with 'Hello world!' as an input:
echo $(cmdin | length) # Prints: 12
</code></pre>
<p>The original type is preserved, which means we can perform typed operations on the input value.</p>
<h4 id="returning-with-cmdout"><a class="header" href="#returning-with-cmdout">Returning with CMDOUT</a></h4>
<p>The <code>cmdout</code> command takes a typed value and writes it to the shell script's CMDOUT pipe. This also makes the program exit.</p>
<h4 id="writing-to-cmdraw"><a class="header" href="#writing-to-cmdraw">Writing to CMDRAW</a></h4>
<p>The <code>cmdraw</code> command takes a <code>stream</code> value and writes it to the shell script's CMDRAW pipe. Only one stream can be piped at a time, so if <code>cmdraw</code> is called while another is pending, the command will simply fail (this can be caught with <code>catch</code>).</p>
<h3 id="input-of-a-command"><a class="header" href="#input-of-a-command">Input of a command</a></h3>
<p>Some commands accept <em>inputs</em> through the command pipe <code>|</code> operator. They can be used this way:</p>
<pre><code class="language-hydre">echo &quot;Hello world!&quot; &gt; ./somefile.txt

read ./somefile.txt # Prints: &quot;Hello world!&quot;

read ./somefile.txt | length # Prints: 12
</code></pre>
<p>How does this work exactly? First, <code>read</code> reads the file and outputs it to CMDOUT as a <code>string</code>, which is then passed to <code>length</code> which happens to accept strings as an input. It then computes the length of the provided input and writes it to CMDOUT, as an <code>int</code>. Which means we can do that:</p>
<pre><code class="language-hydre">echo ${ $(read ./somefile.txt | length) * 2 } # Prints: 24
</code></pre>
<p>The input may be typed and only accept specific types of values. For instance <code>length</code> only accepts strings, so if we try to give it something else:</p>
<pre><code class="language-hydre">echo $(pass 2 | length) # ERROR
</code></pre>
<p>What happens here is that we use the builtin <code>pass</code> command which writes to CMDOUT the exact same value we gave it as an input. Then we give it to <code>length</code>, which fails because it doesn't accept <code>int</code>s.</p>
<p>There's also a shorthand syntax for providing a file's content as CMDIN to a command:</p>
<pre><code class="language-hydre">echo $(length &lt; ./somefile.txt) # Prints: 24
</code></pre>
<p>For commands that only accept <code>string</code> inputs, the file is automatically decoded and converted to a string. Else, it's kept as a <code>stream</code>.</p>
<h2 id="running-in-background"><a class="header" href="#running-in-background">Running in background</a></h2>
<p>It's possible to run multiple commands in parallel by using <em>background commands</em>. A background command runs, as the name suggests, in the background, and so its output isn't visible. If it fails, it won't generate any error nor affect the <code>status()</code> code.</p>
<p>To run a command in backgroud, we use the <code>bg</code> keyword:</p>
<pre><code class="language-hydre">bg hello = sleep 5 -x { i -&gt; echo &quot;Counter: ${i}&quot; }
</code></pre>
<p>This will declare an <code>hello</code> variable and put an <code>int</code> value inside it, which is the background command's <em>identifier</em> (BGID). The command will be started and run in parallel of the current program. For instance, the following program:</p>
<pre><code class="language-hydre">bg hello = sleep 5 -x { i -&gt; echo &quot;Counter: ${i}&quot; } --end { -&gt; echo &quot;Counter completed!&quot; }

for i in 1..=5
  sleep 1
  echo &quot;Loop: ${i}&quot;
end

echo &quot;Loop completed!&quot;
</code></pre>
<p>Will print:</p>
<pre><code class="language-plaintext">Counter: 1
Loop: 1
Counter: 2
Loop: 2
Counter: 3
Loop: 3
Counter: 4
Loop: 4
Counter: 5
Loop: 5
Counter completed!
Loop completed!
</code></pre>
<p>It's possible to wait for a background command by making it run back in the foreground:</p>
<pre><code class="language-hydre">bg hello = sleep 5 # The command runs in background
fg hello # The commands comes back to the foreground
         # The program pauses until it completes like for a normal command
</code></pre>
<p>It's also possible to let the command run even when the program finishes with <code>detach</code>:</p>
<pre><code class="language-hydre">bg hello = sleep 5
detach hello
</code></pre>
<p>Or to stop the background command with <code>kill</code>:</p>
<pre><code class="language-hydre">bg hello = sleep 5 -x { i -&gt; echo &quot;Counter: ${i}&quot; }

sleep 3
kill hello
echo &quot;Killed.&quot;

### Output:
Counter: 1
Counter: 2
Counter: 3
Killed.
&lt;Program stops&gt;###
</code></pre>
<h2 id="environment-variables"><a class="header" href="#environment-variables">Environment variables</a></h2>
<p>While traditional variables are always <a href="#variables-scoping">scoped</a>, <em>environment variables</em> are variables that are provided to the script when it starts, and are forwarded to all scripts the main scripts calls, recursively.</p>
<p>They are mostly used to share configuration between programs.</p>
<p>They are usually set:</p>
<ul>
<li>Globally, using <a href="../applications/Central.html">Central</a></li>
<li>For the terminal, using the terminal application's settings</li>
<li>For the current script, by providing them when running the script</li>
</ul>
<p>The third case is the most common, here is what it looks like:</p>
<pre><code class="language-hydre"># Without environment variables
./myscript.ns

# With environment variables
with MESSAGE=&quot;Hello world!&quot; run ./myscript.ns
</code></pre>
<p>The environment variable will then be provided to <code>./myscript.ns</code>, and will also be available in all scripts this script calls.</p>
<h3 id="reading-an-environment-variable"><a class="header" href="#reading-an-environment-variable">Reading an environment variable</a></h3>
<p>Environment variables cannot be accessed like traditional variables, they must be retrieved through the <code>env</code> builtin function:</p>
<pre><code class="language-hydre"># In &quot;myscript.ns&quot;

var message = env(&quot;MESSAGE&quot;) # any?
</code></pre>
<p>As the variable may not be defined, the function returns a nullable value, so we must check if the variable is indeed defined:</p>
<pre><code class="language-hydre">var message = env(&quot;MESSAGE&quot;)

if none message
  fail &quot;MESSAGE environment variable was not provided&quot;
end
</code></pre>
<p>Now we are sure that <code>message</code> is defined, we get an <code>any</code> value, because we don't know the type of the environment variable. So we must use <a href="#data-validation">type assertions</a> for that:</p>
<pre><code class="language-hydre">var message = env(&quot;MESSAGE&quot;)

if none message
  fail &quot;MESSAGE environment variable was not provided&quot;
end

if message isnt string
  fail &quot;MESSAGE environment variable is not a string&quot;
end

# Here, &quot;message&quot; is a string
</code></pre>
<p>Perfect! Note that, if you want to check if the environment variable exists <em>and</em> is of a specific type at the same time, you can skip the first checking, which is only here to perform specific actions in case the environment variable isn't even defined:</p>
<pre><code class="language-hydre">var message = env(&quot;MESSAGE&quot;)

if message isnt string
  fail &quot;MESSAGE environment variable was not provided or is not a string&quot;
end

# Here, &quot;message&quot; is a string
</code></pre>
<h2 id="commands-typing"><a class="header" href="#commands-typing">Commands typing</a></h2>
<p>For script files to be called as commands, they must define a <code>main</code> function and declare a <em>command description</em>.</p>
<p>Here is an example of command description:</p>
<pre><code class="language-hydre">cmd
  author &quot;Me &lt;my@email&gt;&quot; # Optional
  license &quot;MIT&quot; # Optional
  help &quot;A program that repeats the name of a list of person&quot;
  return void
  args
    # Declare a positional argument named 'names' with a help text
    pos &quot;names&quot;
      type list[string]
      help &quot;List of names to display&quot;
      optional

      # If this argument is omitted, the command will expect the list of names to be provided through CMDIN
      if absent
        cmdin list[string]
      end

    # Declare a dash argument named 'repeat'
    dash &quot;repeat&quot;
      type int
      short &quot;r&quot;
      long &quot;repeat&quot;
      optional

    # Get the time this command took to complete
    flag &quot;duration&quot;
      short &quot;d&quot;
      long &quot;duration&quot;

      # Conditional return type
      # 'present()' also accepts an optional argument name to check if another argument is present
      if present
        return int
      end
end
</code></pre>
<h3 id="arguments-type"><a class="header" href="#arguments-type">Arguments type</a></h3>
<p>Arguments type can be any existing type, or:</p>
<ul>
<li><code>anystr</code>: accepts any type of argument except <code>stream</code>, which will be converted to a <code>string</code> when the command is called (which means the argument will be a <code>string</code> from the command's point of view)</li>
</ul>
<h3 id="enumerations"><a class="header" href="#enumerations">Enumerations</a></h3>
<p>The <code>enum</code> type for arguments indicate the argument only accepts a subset of values (whose type is inferred), which must be specified as a constant. This means the caller cannot use a variable as this argument's value, because the return type may depend on it.</p>
<p>It may also be used as a list of custom values by wrapping the enumeration into a <code>list[...]</code>.</p>
<h3 id="return-type"><a class="header" href="#return-type">Return type</a></h3>
<p>The command's return type can be any existing type.</p>
<p>The options for each argument are:</p>
<ul>
<li><code>type</code>: Required, the type of the argument (nullable types are forbidden)</li>
<li><code>help</code>: A help message indicating what the argument does</li>
<li><code>short</code>: Short name for a dash argument</li>
<li><code>long</code>: Long name for a dash argument</li>
<li><code>optional</code>: Indicate the optional can be omitted (the type will be converted to a nullable one)</li>
<li><code>default</code>: Make the value optional, but with a default value (so the type will not be nullable)</li>
<li><code>requires</code>: Indicate one or several other arguments are required to use this dash one</li>
<li><code>conflicts</code>: Indicate this dash argument cannot be used when one or several other specific arguments are already in use</li>
<li><code>enum</code>: Allow only a subset of values</li>
</ul>
<p>For dash arguments, at least <code>short</code> or <code>long</code> must be provided. Also, <code>optional</code> and <code>default</code> cannot be provided at the same time.
For flag arguments, at least <code>short</code> or <code>long</code> must be provided. Also, <code>type</code>, <code>optional</code>, <code>default</code> and <code>enum</code> are not accepted.</p>
<h3 id="conditionals-1"><a class="header" href="#conditionals-1">Conditionals</a></h3>
<p>Conditions can also use the <code>elif</code> and <code>else</code> keywords, and use the <code>present()</code> and <code>absent()</code> operators as well as usual relational operators like <code>==</code> or <code>&lt;</code> for constant values like enums.</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<p>Here is an example that uses all these options:</p>
<pre><code class="language-hydre">cmd
  args
    # ...
    dash &quot;repeat&quot;
      type int
      help &quot;How many times to repeat the names&quot;
      short &quot;r&quot;
      long &quot;repeat&quot;
      default 1
      requires &quot;arg1&quot;
      conflicts &quot;arg2&quot; &quot;arg3&quot;
      enum list[1, 2, 3, 4]
    end
  end
  # ...
end
</code></pre>
<p>The <code>main</code> function takes arguments with the same name as described in the <code>cmd</code> block, and in the same order:</p>
<pre><code class="language-hydre">fn main(names: list[string], repeat: int?)
  for i in 0..=repeat.default(1)
    echo ${names.join(&quot;, &quot;)}
  end
end
</code></pre>
<p>The script can then be called like any command, with the default <code>$(...)</code> operator returning the script's return value:</p>
<pre><code class="language-hydre">./myscript.ns [&quot;Jack&quot;, &quot;John&quot;] -r 1
# or
var result = $(./myscript.ns [&quot;Jack&quot;, &quot;John&quot;] -r 1)
</code></pre>
<p>Also, know that scripts can <code>fail</code> too. This allows errors to be handled when the script is run as a function:</p>
<pre><code class="language-hydre"># main(names: list[string], repeat: int?) -&gt; fallible

catch $(myscript [&quot;Jack&quot;, &quot;John&quot;])
  ok  _ =&gt; echo &quot;Everything went fine :)&quot;
  err _ =&gt; echo &quot;Something went wrong :(&quot;
end
</code></pre>
<h2 id="native-library"><a class="header" href="#native-library">Native library</a></h2>
<p>The native library is a list of functions that are provided by the shell.</p>
<p>All types have <em>extensions</em>, which are functions that can be called using the <code>.</code> symbol, like <code>my_list.extension()</code>.</p>
<h3 id="utilities"><a class="header" href="#utilities">Utilities</a></h3>
<h4 id="envvarname-string---any"><a class="header" href="#envvarname-string---any"><code>env(varname: string) -&gt; any?</code></a></h4>
<p>Get an <a href="#environment-variables">environment variable</a>.<br />
Returns <code>null</code> if the environment variable cannot be found.</p>
<h4 id="promptmessage-string---string"><a class="header" href="#promptmessage-string---string"><code>prompt(message: string) -&gt; string</code></a></h4>
<p>Ask the user a string.</p>
<h4 id="prompt_intmessage-string---fallible-int"><a class="header" href="#prompt_intmessage-string---fallible-int"><code>prompt_int(message: string) -&gt; fallible int</code></a></h4>
<p>Ask the user an integer number.
Fails if the provided input is not a number.
Fails if the shell is not interactive.</p>
<h4 id="prompt_floatmessage-string---fallible-float"><a class="header" href="#prompt_floatmessage-string---fallible-float"><code>prompt_float(message: string) -&gt; fallible float</code></a></h4>
<p>Ask the user a floating-point number.
Fails if the provided input is not a floating-point number.
Fails if the shell is not interactive.</p>
<h4 id="confirmmessage-string---fallible-bool"><a class="header" href="#confirmmessage-string---fallible-bool"><code>confirm(message: string) -&gt; fallible bool</code></a></h4>
<p>Ask the user to confirm a message using an <code>[Y/n]</code> prompt.
Fails if the shell is not interactive.</p>
<h4 id="chooseoptions-liststring---fallible-int"><a class="header" href="#chooseoptions-liststring---fallible-int"><code>choose(options: list[string]) -&gt; fallible int</code></a></h4>
<p>Ask the user to pick a value from a list and get the index of the chosen value.
Fails if the shell is not interactive.</p>
<h4 id="retry_cmdcmd-command-retries-int---fallible"><a class="header" href="#retry_cmdcmd-command-retries-int---fallible"><code>retry_cmd(cmd: command, retries: int) -&gt; fallible</code></a></h4>
<p>Run a command and retry it a given number of times if it fails.
Fails if the command still fails after all allowed tries.</p>
<h4 id="exit"><a class="header" href="#exit"><code>exit()</code></a></h4>
<p>Make the program exit.</p>
<h4 id="last_failed---bool"><a class="header" href="#last_failed---bool"><code>last_failed() -&gt; bool</code></a></h4>
<p>Check if the previous command failed.<br />
Returns <code>0</code> if no command was ran since the beginning of the script.</p>
<h4 id="rand---float"><a class="header" href="#rand---float"><code>rand() -&gt; float</code></a></h4>
<p>Generate a random floating-point number between 0 and 1.</p>
<h4 id="rand_intlow-int-up-int---fallible-int"><a class="header" href="#rand_intlow-int-up-int---fallible-int"><code>rand_int(low: int, up: int) -&gt; fallible int</code></a></h4>
<p>Generate a random integer between <code>low</code> and <code>up</code>.
Fails if <code>low</code> is not strictly less than <code>up</code>.</p>
<h4 id="rand_floatlow-float-up-float---fallible-float"><a class="header" href="#rand_floatlow-float-up-float---fallible-float"><code>rand_float(low: float, up: float) -&gt; fallible float</code></a></h4>
<p>Generate a floating-point number between <code>low</code> and <code>up</code>.
Fails if <code>low</code> is not strictly less than <code>up</code>.</p>
<h3 id="all-types"><a class="header" href="#all-types">All types</a></h3>
<h4 id="anystr---string"><a class="header" href="#anystr---string"><code>any.str() -&gt; string</code></a></h4>
<p>Turns the provided value into a string, depending on the value's type:</p>
<pre><code class="language-hydre">_ = (true).str()    # true
_ = (3).str(3)      # 3
_ = (3.14).str()    # 3.14
_ = ('B').str()     # B
_ = (&quot;Yoh&quot;).str()   # Yoh
_ = @{ command --arg1 -c 2 -d=4 }.str() # command --arg1 -c 2 -d 4

_ = [&quot;a&quot;,&quot;b&quot;].str() # [ &quot;a&quot;, &quot;b&quot; ]
_ = @{ streamify &quot;Hello world!&quot; }.str() # &quot;&lt;stream&gt;&quot;
</code></pre>
<h3 id="nullable-types-1"><a class="header" href="#nullable-types-1">Nullable types</a></h3>
<h4 id="tisnull---t"><a class="header" href="#tisnull---t"><code>T?.isNull() -&gt; T</code></a></h4>
<p>Check if the value is <code>null</code>.</p>
<pre><code class="language-hydre">var a: int? = 1
var b: int? = null

echo ${a.isNull()} # false
echo ${b.isNull()} # true
</code></pre>
<h4 id="tdefaultfallback-t---t"><a class="header" href="#tdefaultfallback-t---t"><code>T?.default(fallback: T) -&gt; T</code></a></h4>
<p>Use a fallback value in case of <code>null</code>:</p>
<pre><code class="language-hydre">var a: int? = 1
var b: int? = null

echo ${a.default(3)} # 1
echo ${b.default(3)}
</code></pre>
<h4 id="tunwrap---t"><a class="header" href="#tunwrap---t"><code>T?.unwrap() -&gt; T</code></a></h4>
<p>Make the program exit with an error message if the value is null.</p>
<pre><code class="language-hydre">var a = ?(0) # int?
var b = a.unwrap() # int
</code></pre>
<h4 id="texpectmessage-string---t"><a class="header" href="#texpectmessage-string---t"><code>T?.expect(message: string) -&gt; T</code></a></h4>
<p>Make the program exit with a custom error message if 'a' is null</p>
<pre><code class="language-hydre">var a = ?(0) # INt?
var b = a.expect(&quot;'a' should not be null :(&quot;) # int
</code></pre>
<h3 id="characters"><a class="header" href="#characters">Characters</a></h3>
<h4 id="charsingle---bool"><a class="header" href="#charsingle---bool"><code>char.single() -&gt; bool</code></a></h4>
<p>Indicate if a character is made of a single codepoint.</p>
<h4 id="charcodepoints---listint"><a class="header" href="#charcodepoints---listint"><code>char.codepoints() -&gt; list[int]</code></a></h4>
<p>Get the codepoints composing a character.</p>
<h4 id="charlen---int"><a class="header" href="#charlen---int"><code>char.len() -&gt; int</code></a></h4>
<p>Get the number of codepoints composing a character.</p>
<h4 id="charbytes---int"><a class="header" href="#charbytes---int"><code>char.bytes() -&gt; int</code></a></h4>
<p>Get the size of a character, in bytes.</p>
<h3 id="strings"><a class="header" href="#strings">Strings</a></h3>
<h4 id="stringchars---listchar"><a class="header" href="#stringchars---listchar"><code>string.chars() -&gt; list[char]</code></a></h4>
<p>Get the characters composing a string.</p>
<h4 id="stringcodepoints---listint"><a class="header" href="#stringcodepoints---listint"><code>string.codepoints() -&gt; list[int]</code></a></h4>
<p>Get the codepoints composing a string.</p>
<h4 id="stringlen---int"><a class="header" href="#stringlen---int"><code>string.len() -&gt; int</code></a></h4>
<p>Get the number of codepoints composing a string.</p>
<h4 id="stringbytes---int"><a class="header" href="#stringbytes---int"><code>string.bytes() -&gt; int</code></a></h4>
<p>Get the size of a string, in bytes.</p>
<h4 id="stringparse_intbase--10---fallible-int"><a class="header" href="#stringparse_intbase--10---fallible-int"><code>string.parse_int(base = 10) -&gt; fallible int</code></a></h4>
<p>Tries to parse the provided string as a number in the provided base.
Leading zeroes are accepted.
<code>0</code> symbol followed by <code>b</code>, <code>o</code>, <code>d</code> or <code>x</code> is accepted for bases 2, 8, 10 and 16 respectively.
Fails if the string does not represent a number in this base.</p>
<pre><code class="language-hydre">_ = (&quot;2&quot;).parse_int()   # 2
_ = (&quot;A&quot;).parse_int()   # &lt;FAIL&gt;
_ = (&quot;A&quot;).parse_int(16) # 11
</code></pre>
<h4 id="stringparse_floatbase--10---fallible-float"><a class="header" href="#stringparse_floatbase--10---fallible-float"><code>string.parse_float(base = 10) -&gt; fallible float</code></a></h4>
<p>Identical to <code>string.parse_int(base)</code> but with floats.</p>
<h4 id="stringupper_case---string"><a class="header" href="#stringupper_case---string"><code>string.upper_case() -&gt; string</code></a></h4>
<p>Convert a string to uppercase.</p>
<pre><code class="language-hydre">_ = (&quot;aBc&quot;).upper_case() # &quot;ABC&quot;
</code></pre>
<h4 id="stringlower_case---string"><a class="header" href="#stringlower_case---string"><code>string.lower_case() -&gt; string</code></a></h4>
<p>Convert a string to lowercase.</p>
<pre><code class="language-hydre">_ = (&quot;aBc&quot;).lower_case() # &quot;abc&quot;
</code></pre>
<h4 id="stringreverse---string"><a class="header" href="#stringreverse---string"><code>string.reverse() -&gt; string</code></a></h4>
<p>Reverse a string.</p>
<pre><code class="language-hydre">_ = (&quot;abc&quot;).reverse() # &quot;cba&quot;
</code></pre>
<h4 id="stringconcatright-string---string"><a class="header" href="#stringconcatright-string---string"><code>string.concat(right: string) -&gt; string</code></a></h4>
<p>Concatenate two strings (equivalent to <code>&quot;${left}${right}&quot;</code>).</p>
<pre><code class="language-hydre">_ = (&quot;a&quot;).concat(&quot;b&quot;) # &quot;ab&quot;
</code></pre>
<h4 id="stringsplitstr-string-sep-string---string"><a class="header" href="#stringsplitstr-string-sep-string---string"><code>string.split(str: string, sep: string) -&gt; string</code></a></h4>
<p>Split a string into a list.</p>
<pre><code class="language-hydre">split(&quot;ab&quot;, &quot;&quot;)  # [ &quot;a&quot;, &quot;b&quot; ]
split(&quot;a b&quot;, &quot; &quot;) # [ &quot;a&quot;, &quot;b&quot; ]
</code></pre>
<h3 id="lists"><a class="header" href="#lists">Lists</a></h3>
<h4 id="listcharstringify---str"><a class="header" href="#listcharstringify---str"><code>list[char].stringify() -&gt; str</code></a></h4>
<p>Turns a list of characters to a string.</p>
<pre><code class="language-hydre">_ = ([ 'a', 'b', 'c' ].str() == &quot;abc&quot;) # true
</code></pre>
<h4 id="liststringjoinsep-----string"><a class="header" href="#liststringjoinsep-----string"><code>list[string].join(sep = &quot;,&quot;) -&gt; string</code></a></h4>
<p>Join a list of strings with a separator.</p>
<pre><code class="language-hydre">join([ &quot;a&quot;, &quot;b&quot; ])       # &quot;a,b&quot;
join([ &quot;a&quot;, &quot;b&quot; ], &quot;; &quot;) # &quot;a; b&quot;
</code></pre>
<h4 id="listtgetindex-int---t"><a class="header" href="#listtgetindex-int---t"><code>list[T].get(index: int) -&gt; T?</code></a></h4>
<p>Try to get an item from the list, without panicking if the index is out-of-bounds.</p>
<pre><code class="language-hydre">var names = [ &quot;Jack&quot;, &quot;John&quot; ]

names.get(0) # &quot;Jack&quot;
names.get(1) # &quot;John&quot;
names.get(2) # null
</code></pre>
<h4 id="listtexpectindex-number-message-string---t"><a class="header" href="#listtexpectindex-number-message-string---t"><code>list[T].expect(index: number, message: string) -&gt; T</code></a></h4>
<p>Get an item from the list, and panic with a custom error message if the index is out-of-bounds.</p>
<pre><code class="language-hydre">var names = [ &quot;Jack&quot;, &quot;John&quot; ]

names.expect(2, &quot;Third item was not found&quot;)
</code></pre>
<h4 id="listtunshiftvalue-t"><a class="header" href="#listtunshiftvalue-t"><code>list[T].unshift(value: T)</code></a></h4>
<p>Insert a new value at the beginning of the list.</p>
<h4 id="listtpushvalue-t"><a class="header" href="#listtpushvalue-t"><code>list[T].push(value: T)</code></a></h4>
<p>Push a new value at the end of the list.</p>
<h4 id="listtunshift---t"><a class="header" href="#listtunshift---t"><code>list[T].unshift() -&gt; T?</code></a></h4>
<p>Remove the first value from the list and return it.</p>
<h4 id="listtpop---t"><a class="header" href="#listtpop---t"><code>list[T].pop() -&gt; T?</code></a></h4>
<p>Remove the last value from the list and return it.</p>
<h4 id="listtsortasc--true---listt"><a class="header" href="#listtsortasc--true---listt"><code>list[T].sort(asc = true) -&gt; list[T]</code></a></h4>
<p>Sorts a list.</p>
<pre><code class="language-hydre">_ = [ 2, 8, 4 ].sort()      # [ 2, 4, 8 ]
_ = [ 2, 8, 4 ].sort(false) # [ 8, 4, 2 ]
</code></pre>
<h4 id="listtreverse---listt"><a class="header" href="#listtreverse---listt"><code>list[T].reverse() -&gt; list[T]</code></a></h4>
<p>Reverse a list.</p>
<pre><code class="language-hydre">_ = [ 2, 8, 4 ].reverse() # [ 4, 8, 2 ]
</code></pre>
<h4 id="listtlen---int"><a class="header" href="#listtlen---int"><code>list[T].len() -&gt; int</code></a></h4>
<p>Count the number of entries in a list.</p>
<pre><code class="language-hydre">_ = [ 2, 8, 4 ].len() # 3
</code></pre>
<h4 id="listtconcatanother-listt---listt"><a class="header" href="#listtconcatanother-listt---listt"><code>list[T].concat(another: list[T]) -&gt; list[T]</code></a></h4>
<p>Concatenate two lists.</p>
<pre><code class="language-hydre">_ = [ 1, 2 ].concat([ 3, 4 ]) # [ 1, 2, 3, 4 ]
</code></pre>
<h4 id="listtconcatlists-listlistt---listt"><a class="header" href="#listtconcatlists-listlistt---listt"><code>list[T].concat(lists: list[list[T]]) -&gt; list[T]</code></a></h4>
<p>Concatenate multiple lists.</p>
<pre><code class="language-hydre">_ = [ 1, 2 ].concat([ [ 3, 4 ], [ 5, 6 ] ]) # [ 1, 2, 3, 4, 5, 6 ]
</code></pre>
<h3 id="maps"><a class="header" href="#maps">Maps</a></h3>
<h4 id="mapk-vhaskey-k---bool"><a class="header" href="#mapk-vhaskey-k---bool"><code>map[K, V].has(key: K) -&gt; bool</code></a></h4>
<p>Check if a key exists in a map.</p>
<h4 id="mapk-vgetkey-k---v"><a class="header" href="#mapk-vgetkey-k---v"><code>map[K, V].get(key: K) -&gt; V?</code></a></h4>
<p>Get a value without panicking if the key doesn't exist.</p>
<h4 id="mapk-vkeys---listk"><a class="header" href="#mapk-vkeys---listk"><code>map[K, V].keys() -&gt; list[K]</code></a></h4>
<p>Get all keys of a map.</p>
<h4 id="mapk-vvalues---listv"><a class="header" href="#mapk-vvalues---listv"><code>map[K, V].values() -&gt; list[V]</code></a></h4>
<p>Get all values of a map.</p>
<h4 id="mapk-vvalues---liststruct--key-k-value-v-"><a class="header" href="#mapk-vvalues---liststruct--key-k-value-v-"><code>map[K, V].values() -&gt; list[struct { key: K, value: V }]</code></a></h4>
<p>Turn a map into a list.</p>
<h4 id="mapk-vexpectkey-k-message-string---v"><a class="header" href="#mapk-vexpectkey-k-message-string---v"><code>map[K, V].expect(key: K, message: string) -&gt; V</code></a></h4>
<p>Get an item from the map, and panic with a custom error message if the key doen't exist.</p>
<h4 id="mapk-vdeletekey-k---bool"><a class="header" href="#mapk-vdeletekey-k---bool"><code>map[K, V].delete(key: K) -&gt; bool</code></a></h4>
<p>Delete a key, returns <code>false</code> if the key didn't exist in the map, or <code>true</code> otherwise.</p>
<h4 id="mapk-vcount---int"><a class="header" href="#mapk-vcount---int"><code>map[K, V].count() -&gt; int</code></a></h4>
<p>Count the number of entries in a map.</p>
<h3 id="commands"><a class="header" href="#commands">Commands</a></h3>
<h4 id="commandrun---int"><a class="header" href="#commandrun---int"><code>command.run() -&gt; int</code></a></h4>
<p>Run the command and gets its status code after exit.</p>
<h4 id="commandfallible"><a class="header" href="#commandfallible"><code>command.fallible()</code></a></h4>
<p>Run the command and fail if the status code after exit is not 0.<br />
Equivalent to calling the command with simple parenthesis like <code>cmd()</code>.</p>
<h4 id="commandret_str---string"><a class="header" href="#commandret_str---string"><code>command.ret_str() -&gt; string</code></a></h4>
<p>Run the command and get its stringified return value.</p>
<h4 id="commandcmdraw---stream"><a class="header" href="#commandcmdraw---stream"><code>command.cmdraw() -&gt; stream</code></a></h4>
<p>Run the command and get its CMDRAW output.</p>
<h4 id="commandcmdmsg---liststring"><a class="header" href="#commandcmdmsg---liststring"><code>command.cmdmsg() -&gt; list[string]</code></a></h4>
<p>Run the command and get its CMDMSG output.</p>
<h4 id="commandcmderr---liststring"><a class="header" href="#commandcmderr---liststring"><code>command.cmderr() -&gt; list[string]</code></a></h4>
<p>Run the command and get its CMDERR output.</p>
<h4 id="commandoutput---liststring"><a class="header" href="#commandoutput---liststring"><code>command.output() -&gt; list[string]</code></a></h4>
<p>Run the command and get its CMDOUT and CMDERR outputs combined.</p>
<h3 id="streams-1"><a class="header" href="#streams-1">Streams</a></h3>
<h4 id="streampending---bool"><a class="header" href="#streampending---bool"><code>stream.pending() -&gt; bool</code></a></h4>
<p>Check if the stream is still pending. If the pipe is complete (which means if its pipe is closed), <code>false</code> will be returned.</p>
<h4 id="streamsize_hint---int"><a class="header" href="#streamsize_hint---int"><code>stream.size_hint() -&gt; int?</code></a></h4>
<p>Get the stream's size hint. If no size hint was provided for this stream, <code>null</code> will be returned.</p>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<h3 id="guess-the-number"><a class="header" href="#guess-the-number">Guess The Number</a></h3>
<pre><code class="language-hydre">while true
  var won = false
  var secret = rand_int(0, 100)

  echo &quot;Secret number between 0 and 100 has been chosen.&quot;

  while !won
    var user_input = retry prompt_int(&quot;Please input your guess: &quot;)

    if user_input &lt; secret
      echo &quot;It's higher!&quot;
    elif user_input &gt; secret
      echo &quot;It's lower!&quot;
    else
      echo &quot;You guessed the number \\o/!&quot;
      won = true
    end
  end

  tries = retry(5) confirm(&quot;Do you want to play again?&quot;)

  if !(retry(5) confirm(&quot;Do you want to play again?&quot;))
    echo &quot;Goodbye!&quot;
    break
  end
end
</code></pre>
<h2 id="native-commands"><a class="header" href="#native-commands">Native commands</a></h2>
<p>The native commands are commands that are available in every program without import.</p>
<h3 id="echo-display-a-value"><a class="header" href="#echo-display-a-value"><code>echo</code>: display a value</a></h3>
<p>Display a value to CMDOUT.</p>
<pre><code class="language-hydre"># echo [-n] { &lt;anystr&gt; | -b &lt;stream&gt;}
#
# &quot;-b&quot;: print a stream as UTF-8
# &quot;-n&quot;: don't put a newline break at the end of the content

echo &quot;Hello world&quot;
echo -n &quot;Hello world!&quot;
echo -b $(streamify &quot;Hello world!&quot;)
</code></pre>
<h3 id="wt-write-a-file"><a class="header" href="#wt-write-a-file"><code>wt</code>: write a file</a></h3>
<p>Write a content to a file.</p>
<pre><code class="language-hydre"># wt [-a] [-n] [-c] &lt;path&gt; &lt;anystr&gt;
#
# &quot;-a&quot;: append to the end of the file
# &quot;-n&quot;: don't append a newline symbol at the end of the content
# &quot;-c&quot;: fail if the file doesn't exist instead of creating it
</code></pre>
<p>Note that sometimes it can be clearer to use a redirection pipe:</p>
<pre><code class="language-hydre"># Overwrite file
echo &quot;Hello world!&quot; &gt; ./test.txt

# Append to file
echo &quot;Hello world!&quot; &gt;&gt; ./test.txt
</code></pre>
<h3 id="rd-read-a-file"><a class="header" href="#rd-read-a-file"><code>rd</code>: read a file</a></h3>
<p>Read a file as a <code>string</code> value.</p>
<pre><code class="language-hydre"># rd [-s] [--stream-size &lt;int&gt;] &lt;path&gt;
#
# &quot;-s&quot;: read a stream instead of reading the full content
# &quot;--stream-size&quot;: specify the size of the stream when &quot;-s&quot; is provided (rounded to higher pipe buffer multiplier)
</code></pre>
<h3 id="mkdir-create-a-directory"><a class="header" href="#mkdir-create-a-directory"><code>mkdir</code>: create a directory</a></h3>
<p>Create a new directory.</p>
<pre><code class="language-hydre"># mkd [-s] &lt;path&gt;
#
# &quot;-s&quot;: fail if the directory already exists
</code></pre>
<h3 id="ren-rename-a-filesystem-item"><a class="header" href="#ren-rename-a-filesystem-item"><code>ren</code>: rename a filesystem item</a></h3>
<p>Rename a filesystem item.</p>
<pre><code class="language-hydre"># re [-m] &lt;oldname: path&gt; &lt;newname: path&gt;
#
# &quot;-m&quot;: move if the 'newname' is located inside another directory
</code></pre>
<h3 id="mv-move-a-filesystem-item"><a class="header" href="#mv-move-a-filesystem-item"><code>mv</code>: move a filesystem item</a></h3>
<pre><code class="language-hydre"># mv [-n] &lt;file: path&gt; &lt;dest_dir: path&gt;
#
# &quot;-n&quot;: create the target directory if it does not exist
</code></pre>
<h3 id="rm-remove-a-filesystem-item"><a class="header" href="#rm-remove-a-filesystem-item"><code>rm</code>: remove a filesystem item</a></h3>
<p>Remove a filesystem item.</p>
<pre><code class="language-hydre"># rm [-r | --recursive] [-n | --non-empty] [-t | --trash] {&lt;path&gt; | -l &lt;list[path]&gt;}
#
# &quot;-r&quot;: allow removing empty directory
# &quot;-n&quot;: allow removing even non-empty directories
# &quot;-l&quot;: remove a list of paths
# &quot;-t&quot;: move the item to the user's trash
</code></pre>
<h3 id="ls-list-filesystem-items"><a class="header" href="#ls-list-filesystem-items"><code>ls</code>: list filesystem items</a></h3>
<p>List filesystem items.</p>
<pre><code class="language-hydre"># ls [-t | --tree] [-r | --recursive] [-h | --hidden] [--file-only | --dir-only] [&lt;path&gt;]
#
# &quot;-t&quot;: display as a tree (implies &quot;-r&quot;)
# &quot;-r&quot;: list recursively
# &quot;-h&quot;: list hidden files
# &quot;--file-only&quot;: only display files
# &quot;--dir-only&quot;: only display directories
</code></pre>
<h3 id="fd-find-filesystem-items"><a class="header" href="#fd-find-filesystem-items"><code>fd</code>: find filesystem items</a></h3>
<p>Find filesystem items matching provided criterias.</p>
<pre><code class="language-hydre"># fd [-t | --types list[&quot;dir&quot; | &quot;file&quot; | &quot;symlink&quot; | &quot;device&quot;]]
#    [-a | --absolute]
#    [-L | --follow]
#    [-e | --extension &lt;string&gt;]
#    [-n | --name &lt;string&gt;]
#    [-r | --regex &lt;string&gt;]
#    [-i | --ignore-case]
#    [-x | --exec &lt;command&gt;] &lt;path&gt;
#
# &quot;-t&quot;: only list items of a given type (by default, only files and symlinks are shown)
# &quot;-a&quot;: list absolute file paths instead of relative ones
# &quot;-L&quot;: follow symbolic links
# &quot;-e&quot;: only list files with the provided extension (directory will be excluded)
# &quot;-n&quot;: only list items whose name contain the provided string (`^` and `$` can be used for indicating items must start or end by it)
# &quot;-r&quot;: only list items matching a provided POSIX regex
# &quot;-i&quot;: ignore case (requires &quot;-n&quot; or &quot;-r&quot;)
# &quot;-x&quot;: execute a command for each found item
</code></pre>
<h3 id="syml-manage-symlinks"><a class="header" href="#syml-manage-symlinks"><code>syml</code>: manage symlinks</a></h3>
<p>Manage symbolic links.</p>
<pre><code class="language-hydre"># sl {-r | --read} &lt;path&gt;: check a symlink's target
#
# sl [-u | --update] &lt;srcpath&gt; &lt;targetpath&gt;: create a symlink
#
# &quot;-u&quot;: update the symlink to the new target path if it already exists instead of failing
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../specs/shell.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../specs/services.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../specs/shell.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../specs/services.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
